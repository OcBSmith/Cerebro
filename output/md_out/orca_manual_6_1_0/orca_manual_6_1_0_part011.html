<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<title>orca_manual_6_1_0_part011</title>
<meta name="generator" content="Docling HTML Serializer"/>
<style>
    html {
        background-color: #f5f5f5;
        font-family: Arial, sans-serif;
        line-height: 1.6;
    }
    body {
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem;
        background-color: white;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1, h2, h3, h4, h5, h6 {
        color: #333;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    h1 {
        font-size: 2em;
        border-bottom: 1px solid #eee;
        padding-bottom: 0.3em;
    }
    table {
        border-collapse: collapse;
        margin: 1em 0;
        width: 100%;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
    }
    th {
        background-color: #f2f2f2;
        font-weight: bold;
    }
    figure {
        margin: 1.5em 0;
        text-align: center;
    }
    figcaption {
        color: #666;
        font-style: italic;
        margin-top: 0.5em;
    }
    img {
        max-width: 100%;
        height: auto;
    }
    pre {
        background-color: #f6f8fa;
        border-radius: 3px;
        padding: 1em;
        overflow: auto;
    }
    code {
        font-family: monospace;
        background-color: #f6f8fa;
        padding: 0.2em 0.4em;
        border-radius: 3px;
    }
    pre code {
        background-color: transparent;
        padding: 0;
    }
    .formula {
        text-align: center;
        padding: 0.5em;
        margin: 1em 0;
        background-color: #f9f9f9;
    }
    .formula-not-decoded {
        text-align: center;
        padding: 0.5em;
        margin: 1em 0;
        background: repeating-linear-gradient(
            45deg,
            #f0f0f0,
            #f0f0f0 10px,
            #f9f9f9 10px,
            #f9f9f9 20px
        );
    }
    .page-break {
        page-break-after: always;
        border-top: 1px dashed #ccc;
        margin: 2em 0;
    }
    .key-value-region {
        background-color: #f9f9f9;
        padding: 1em;
        border-radius: 4px;
        margin: 1em 0;
    }
    .key-value-region dt {
        font-weight: bold;
    }
    .key-value-region dd {
        margin-left: 1em;
        margin-bottom: 0.5em;
    }
    .form-container {
        border: 1px solid #ddd;
        padding: 1em;
        border-radius: 4px;
        margin: 1em 0;
    }
    .form-item {
        margin-bottom: 0.5em;
    }
    .image-classification {
        font-size: 0.9em;
        color: #666;
        margin-top: 0.5em;
    }
</style>
</head>
<body>
<div class='page'>
<pre><code>3 H -0.500000 0.870000 1.740000 4 H -0.500000 -0.870000 1.740000 5 H 1.000000 0.000000 1.740000 ------------------------------------------------------------------------------------Match: 1, Assigned Fragment: 2 ------------------------------------------Name: CH3 Method: Ext_lib Natoms: 4 Charge: 0 Mult: 1 2 C 1.300000 0.000000 -0.460000 6 H 1.300000 0.000000 -1.530000 7 H 1.800000 0.870000 -0.100000 8 H 1.800000 -0.870000 -0.100000 ------------------------------------------</code></pre>
<h2>® Note</h2>
<ul>
<li style="list-style-type: '· ';">XZYFRAGLIB allows the inclusion of up to 10 files. Each file may contain multiple fragment definitions; however, each definition must consist of a single, connected molecule-unconnected structures within a single definition are not allowed.</li>
<li style="list-style-type: '· ';">The format of Mylib.xyz follows the standard XYZ file structure, but optionally supports three identifiers: CHARGE , MULT , and NAME , with NAME expected to appear last. These identifiers are printed when a fragment is recognized, though they are not currently used in any calculations.</li>
<li style="list-style-type: '· ';">Subsequent modifications to fragments by other methods (see Fusebyatoms and Extend below) do not affect the fragment's CHARGE or MULT values in the identifiers.</li>
</ul>
<h2>ǩ Important</h2>
<ul>
<li style="list-style-type: '· ';">ORCA's VF2 subgraph isomorphism algorithm is based solely on atomic connectivity; it does not consider stereochemistry or bond orders.</li>
<li style="list-style-type: '· ';">Fragment assignment by FragProc Extlib follows the order of the files listed in XZYFRAGLIB and the order of fragment definitions within each file. Since an atom is excluded from subsequent matching once it has been assigned to a fragment, the order in which fragments are defined in the library is critically important. For example, in the previous case , if CH3 is defined before CH3O in Mylib.xyz , both CH3 groups in the input file will be matched first. This prevents CH3O from being recognized later, even if it is present in the system.</li>
<li style="list-style-type: '· ';">Atom assignment to fragments follows the order in which atoms appear in the geometry. In the previous example , the CH3O fragment could be assigned using either the C(1)-O or C(2)-O bond. However, since C(1) appears first in the geometry, it is selected for the CH3O fragment.</li>
</ul>
<p>(continued from previous page)</p>
<h2>Automatic Fragmentation: Extend</h2>
<p>Many fragments in the internal libraries represent incomplete molecular structures. Therefore, in some cases, it is necessary to add additional hydrogen atoms-or, in certain situations, a hydroxyl group-to complete the system. The FragProc Extend addresses this by identifying oxygen atoms bonded to carbon atoms in previously assigned fragments, as well as hydrogen atoms bonded to carbon, nitrogen, or oxygen. It then extends the corresponding fragments to include these atoms.</p>
<p>Consider the example below, which consists of a zwitterionic glycine molecule fragmented using an external library that defines a C-C-N fragment. In this case, FragProc Extend can be applied to add the missing oxygen and hydrogen atoms, thereby completing the molecular structure.</p>
<pre><code>%frag PrintLevel 3 FragProc Extlib, Extend XZYFRAGLIB "Mylib.xyz" end *xyz 0 1 N 0.000000 0.000000 0.000000 C 0.000000 0.000000 1.460000 C 1.403962 0.000000 2.015868 O 1.837767 0.962613 2.627089 O 2.161436 -0.947142 1.883370 H 0.423874 -0.764689 -0.525339 H -0.538292 -0.884247 1.831954 H -0.538292 0.884247 1.831954 H -0.970478 0.016940 -0.313504 H 0.499909 0.831989 -0.313504 *</code></pre>
<p>Where Mylib.xyz in this case is:</p>
<pre><code>3 Name CCN C 0.000000 0.000000 0.000000 C 0.000000 0.000000 1.500000 N 1.376503 0.000000 -0.486661</code></pre>
<p>The result is an initial assignment of the C-C-N fragment, followed by an extension of the fragment to include two oxygen atoms and five hydrogen atoms.</p>
<pre><code>------------------------------------------Match: 1, Assigned Fragment: 1 ------------------------------------------Name: CCN Method: Ext_lib Natoms: 3 Charge: 0 Mult: 1 0 N 0.000000 0.000000 0.000000 1 C 0.000000 0.000000 1.460000 2 C 1.403962 0.000000 2.015868 ------------------------------------------=================================================== Tfragmentator: Extending Fragments =================================================== Extending Fragment 0 with O (3) Extending Fragment 0 with O (4) Extending Fragment 0 with H (6) Extending Fragment 0 with H (7) Extending Fragment 0 with H (5) Extending Fragment 0 with H (8)</code></pre>
<p>(continues on next page)</p>
<pre><code>Extending Fragment 0 with H (9)</code></pre>
<pre><code>ǩ Important · FragProc Extend attempts to extend any previously assigned fragment. · FragProc Extend does not modify the Charge and Mult identifiers of fragments.</code></pre>
<h2>Automatic Fragmentation: Fusebyatoms</h2>
<p>When multiple fragmentation procedures are used in combination, it may be necessary to merge two previously assigned fragments into one. This can be achieved using the FragProc Fusebyatoms procedure, which identifies atom pairs that should belong to the same fragment, as specified in FuseAtomPairs .</p>
<p>In the example below, the objective is to fragment a propane molecule into a CH3 group and a CH3-CH2 fragment. One way to achieve this is by first applying FragProc FunctionalGroups , which fragments the molecule into two CH3 groups and one CH2 group. The CH2 group can then be merged with one of the CH3 groups. This is done by specifying the carbon atoms of the CH2 and one CH3 group in the FuseAtomPairs directive: FuseAtomPairs</p>
<p>{0 1} end .</p>
<pre><code>%frag printlevel 3 FragProc FunctionalGroups, Fusebyatoms FuseAtomPairs {0 1} end end *xyz 0 1 C 0.000000 1.270000 -0.260000 C 0.000000 -0.000000 0.580000 C 0.000000 -1.270000 -0.260000 H -0.890000 1.320000 -0.910000 H 0.890000 1.320000 -0.910000 H 0.000000 2.180000 0.370000 H 0.880000 -0.000000 1.250000 H -0.880000 -0.000000 1.250000 H 0.890000 -1.320000 -0.910000 H 0.000000 -2.180000 0.370000 H -0.880000 -1.300000 -0.910000 *</code></pre>
<p>The output from the fragmentator first reports the initial fragmentation performed by the Functional_groups library, followed by a message indicating the subsequent fusion of fragments as specified by the FuseAtomPairs directive.</p>
<pre><code>=================================================== Tfragmentator: Fragmenting by Functional_groups =================================================== ------------------------------------------Match: 1, Assigned Fragment: 1 ------------------------------------------Name: CH3 Method: Functional_groups Natoms: 4 Charge: 0 Mult: 1 0 C 0.000000 1.270000 -0.260000 3 H -0.890000 1.320000 -0.910000 4 H 0.890000 1.320000 -0.910000 5 H 0.000000 2.180000 0.370000</code></pre>
<p>(continued from previous page)</p>
<p>(continues on next page)</p>
<p>(continued from previous page)</p>
<h2>Automatic Fragmentation: Delete and advanced fragmentation workflows</h2>
<p>Almost all fragmentation schemes have an associated delete procedure, which removes the fragments generated by that specific scheme. This enables the construction of advanced fragmentation workflows, where a procedure can temporarily 'protect' certain atoms from being fragmented by subsequent methods. These protected fragments can later be deleted, allowing the atoms to be reprocessed using a different fragmentation approach.</p>
<p>Consider the system below , which consists of both a phenylalanine molecule and a benzene molecule. The goal is to fragment the phenylalanine into its backbone, one CH2 group, and the phenyl ring, while fragmenting the benzene into six individual CH fragments.</p>
<p>On one hand, by combining the three fragmentation procedures FragProc AABackbone, Extend, AASCFinegrained - the desired fragmentation of phenylalanine can be achieved. The AABackbone and Extend options identify the aminoacid backbone, while AASCFinegrained separates the CH2 group and the phenyl ring into distinct fragments. Meanwhile, the benzene molecule can be fragmented into six individual CH fragments using FragProc Extlib , which relies on an external library defining the CH fragment. However, these two fragmentation schemes are incompatible. When FragProc AASCFinegrained is applied to the entire system, it fragments not only the phenylalanine side chain but also breaks the benzene ring into a phenyl group and a hydrogen atom. Conversely, if FragProc Extlib is applied first to benzene, it may inadvertently fragment the phenylalanine residue, leading to undesired structural splits.</p>
<p>A viable approach to achieve the desired fragmentation involves first identifying the amino acid using FragProc Aminoacids . This procedure assigns all atoms that belong to amino acid fragments, thereby protecting them from reassignment by subsequent fragmentation steps. The benzene molecule can then be fragmented using an external library via FragProc Extlib . Finally, the phenylalanine fragment is removed using FragProc DelAminoacids , allowing it to be re-fragmented as needed. All these operations are executed by simply concatenating the procedures as follows: FragProc Aminoacids, Extlib, DelAminoacids, AABackbone, Extend, AASCFinegrained</p>
<pre><code>%frag PrintLevel 3 FragProc Aminoacids, Extlib, DelAminoacids, AABackbone, Extend, AASCFinegrained XZYFRAGLIB "Mylib.xyz" STOREFRAGS true end *xyz 0 1 O 1.300780 3.093320 1.571260 C 0.407700 2.826000 0.770390 O -0.101890 3.606620 -0.030470 C -0.115350 1.396690 0.770390 N -1.564350 1.396690 0.770390 H -1.900780 1.872730 1.595200 H 0.242580 0.884560 1.663540 H -1.901490 0.444630 0.770390 H -1.901016 1.873069 -0.054118 C 0.436090 0.696200 -0.461750 H 1.512450 0.863150 -0.502770 H -0.018950 1.150700 -1.341790 C 0.178410 -0.790680 -0.515340 C -0.895760 -1.288470 -1.262580 C -1.134680 -2.667040 -1.312270 C -0.299410 -3.547820 -0.614730 C 0.774760 -3.050040 0.132500 C 1.013680 -1.671470 0.182200 H 1.842330 -1.287460 0.758630 H 1.419110 -3.729500 0.670600 H -0.483720 -4.611290 -0.653070 H -1.963330 -3.051050 -1.888700 H -1.540110 -0.609010 -1.800680 C 1.181325 -3.732146 -2.620584 C 2.016592 -4.612923 -1.923046 C 3.090772 -4.115131 -1.175824 C 3.329684 -2.736563 -1.126139 C 2.494417 -1.855785 -1.823677 C 1.420237 -2.353577 -2.570900 H 0.770518 -1.668458 -3.113485 H 0.422252 -4.288369 -3.129823 H 1.830753 -5.685253 -1.961693 H 3.740491 -4.800250 -0.633239 H 4.165243 -2.349352 -0.544907 H 2.680256 -0.783455 -1.785030 *</code></pre>
<h2>Where 'Mylib.xyz' in this case is:</h2>
<pre><code>2 NAME CH C 0.00 0.00 0.00 H 1.08 0.00 0.00</code></pre>
<p>The complete fragmentation sequence follows the same structure as in previous examples. In this case, the message Deleted 1 fragments is printed after the fragment assignment performed by Ext_lib , indicating that a fragment previously defined by FragProc Aminoacids has been successfully removed.</p>
<pre><code>=================================================== Tfragmentator: Fragmenting by Amino_Acids =================================================== ------------------------------------------Match: 1, Assigned Fragment: 1</code></pre>
<p>(continues on next page)</p>
<pre><code>------------------------------------------Name: CPHE Method: Amino_Acids Natoms: 21 Charge: -1 Mult: 1 0 O 1.300780 3.093320 1.571260 1 C 0.407700 2.826000 0.770390 2 O -0.101890 3.606620 -0.030470 3 C -0.115350 1.396690 0.770390 4 N -1.564350 1.396690 0.770390 5 H -1.900780 1.872730 1.595200 6 H 0.242580 0.884560 1.663540 9 C 0.436090 0.696200 -0.461750 10 H 1.512450 0.863150 -0.502770 11 H -0.018950 1.150700 -1.341790 12 C 0.178410 -0.790680 -0.515340 13 C -0.895760 -1.288470 -1.262580 14 C -1.134680 -2.667040 -1.312270 15 C -0.299410 -3.547820 -0.614730 16 C 0.774760 -3.050040 0.132500 17 C 1.013680 -1.671470 0.182200 18 H 1.842330 -1.287460 0.758630 19 H 1.419110 -3.729500 0.670600 20 H -0.483720 -4.611290 -0.653070 21 H -1.963330 -3.051050 -1.888700 22 H -1.540110 -0.609010 -1.800680 ------------------------------------------=================================================== Tfragmentator: Fragmenting by Ext_lib =================================================== **** **** There are 1 Ref structures found in file Mylib.xyz **** ------------------------------------------Match: 1, Assigned Fragment: 2 ------------------------------------------Name: CH Method: Ext_lib Natoms: 2 Charge: 0 Mult: 1 23 C 1.181325 -3.732146 -2.620584 30 H 0.422252 -4.288369 -3.129823 ------------------------------------------------------------------------------------Match: 2, Assigned Fragment: 3 ------------------------------------------Name: CH Method: Ext_lib Natoms: 2 Charge: 0 Mult: 1 24 C 2.016592 -4.612923 -1.923046 31 H 1.830753 -5.685253 -1.961693 ------------------------------------------... ------------------------------------------Match: 6, Assigned Fragment: 7 ------------------------------------------Name: CH Method: Ext_lib Natoms: 2 Charge: 0 Mult: 1</code></pre>
<p>(continued from previous page)</p>
<p>(continues on next page)</p>
<pre><code>28 C 1.420237 -2.353577 -2.570900 29 H 0.770518 -1.668458 -3.113485 ------------------------------------------ =================================================== Tfragmentator: Deleting Fragments (Amino_Acids) =================================================== Deleted 1 fragments =================================================== Tfragmentator: Fragmenting by Backbone =================================================== ------------------------------------------ Match: 1, Assigned Fragment: 7 ------------------------------------------ Name: CO-NH3-CH Method: AA_Backbone Natoms: 8 Charge: 0 Mult: 0 0 O 1.300780 3.093320 1.571260 1 C 0.407700 2.826000 0.770390 3 C -0.115350 1.396690 0.770390 4 N -1.564350 1.396690 0.770390 5 H -1.900780 1.872730 1.595200 6 H 0.242580 0.884560 1.663540 7 H -1.901490 0.444630 0.770390 8 H -1.901016 1.873069 -0.054118 ------------------------------------------ =================================================== Tfragmentator: Extending Fragments =================================================== Extending Fragment 6 with O (2) =================================================== Tfragmentator: Fragmenting by AA_SideChains_FG =================================================== ------------------------------------------ Match: 1, Assigned Fragment: 8 ------------------------------------------ Name: Ph Method: AA_SideChains_FG Natoms: 11 Charge: 0 Mult: 1 12 C 0.178410 -0.790680 -0.515340 13 C -0.895760 -1.288470 -1.262580 14 C -1.134680 -2.667040 -1.312270 15 C -0.299410 -3.547820 -0.614730 16 C 0.774760 -3.050040 0.132500 17 C 1.013680 -1.671470 0.182200 18 H 1.842330 -1.287460 0.758630 19 H 1.419110 -3.729500 0.670600 20 H -0.483720 -4.611290 -0.653070 21 H -1.963330 -3.051050 -1.888700 22 H -1.540110 -0.609010 -1.800680 ------------------------------------------ ------------------------------------------ Match: 1, Assigned Fragment: 9 ------------------------------------------ Name: CH2 Method: AA_SideChains_FG Natoms: 3 Charge: 0 Mult: 1</code></pre>
<p>(continued from previous page)</p>
<p>(continues on next page)</p>
<p>(continued from previous page)</p>
<table><tbody><tr><td>9 C</td><td>0.436090</td><td>0.696200</td><td>-0.461750</td></tr><tr><td>10 H</td><td>1.512450</td><td>0.863150</td><td>-0.502770</td></tr><tr><td>11 H</td><td>-0.018950</td><td>1.150700</td><td>-1.341790</td></tr></tbody></table>
<p>Table Table 2.61 lists the corresponding delete procedure associated with each fragmentation method.</p>
<table><caption><div class="caption">Table 2.61: Simple input keywords for Fragment detection and their corresponding deletion procedure</div></caption><tbody><tr><th>Fragment detection Keyword</th><th>Fragment deletion Keyword</th></tr><tr><td>Extlib</td><td>DELExtlib</td></tr><tr><td>Connectivity</td><td>DELConnectivity</td></tr><tr><td>Atomic</td><td>DELAtomic</td></tr><tr><td>FunctionalGroups</td><td>DELFunctionalGroups</td></tr><tr><td>NotAssigned</td><td></td></tr><tr><td>Backbone</td><td>DELBackbone</td></tr><tr><td>SeqBackbone</td><td>DELSeqBackbone</td></tr><tr><td>AABackbone</td><td>DELAABackbone</td></tr><tr><td>Aminoacids</td><td>DELAminoacids</td></tr><tr><td>AASideChains</td><td>DELAASideChains</td></tr><tr><td>AASCFineGrained</td><td>DELAASCFineGrained</td></tr><tr><td>NABackbone</td><td>DELNABackbone</td></tr><tr><td>NABBFineGrained</td><td>DELNABBFineGrained</td></tr><tr><td>SEQNABackbone</td><td>DELSEQNABackbone</td></tr><tr><td>NucleoticAcid</td><td>DELNucleoticAcid</td></tr><tr><td>NASideChains</td><td>DELNASideChains</td></tr><tr><td>Solvents</td><td>DELSolvents</td></tr><tr><td>Water</td><td>DELWater</td></tr><tr><td>Extend</td><td></td></tr><tr><td>FuseByAtoms</td><td></td></tr></tbody></table>
<h2>2.18.3 Options available in the %frag input block</h2>
<p>Table Table 2.62 contains a list of the options available in the %frag input block.</p>
<table><caption><div class="caption">Table 2.62: List of options in the %frag input block</div></caption><tbody><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr><tr><td>Printlevel</td><td>Integer</td><td>1</td><td>Verbose output control for automated fragmentation.</td></tr><tr><td>STOREFRAGS</td><td>Boolean</td><td>False</td><td>Stores assigned fragments in a .fragments.xyz file.</td></tr><tr><td>DoInterFragBonds</td><td>Boolean</td><td>False</td><td>Automatically detects bonds between fragments for Co- VaLED analysis.</td></tr><tr><td>XZYFRAGLIB</td><td>String</td><td>None</td><td>Filenames used in FragProc Extlib .</td></tr><tr><td>FragProc</td><td>See Table 2.60, and Table</td><td>ExtLib, Connectivity</td><td>Fragmentation procedures to be applied automatically.</td></tr><tr><td>Usetopology</td><td>Boolean</td><td>False</td><td>Generate main geometry graph based on .prms file.</td></tr></tbody></table>
<p>continues on next page</p>
<table><caption><div class="caption">Table 2.62 - continued from previous page</div></caption><tbody><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr><tr><td>TopolFile</td><td>String</td><td>&quot;&quot;</td><td>Topology file name to been used when Usetopology True</td></tr><tr><td>PrintInputFlags</td><td>Boolean</td><td>True</td><td>Writes a %frag block equivalet to current calculation frag- ments.</td></tr></tbody></table>
<h2>2.19 ORCA and Symmetry</h2>
<p>For most of its life, ORCA did not take advantage of molecular symmetry. Starting from version 2.8 (released in September 2010), there has been at least limited use. On request (using the simple keyword UseSym for instance, see below), the program detects the point group, orients the molecule, cleans up the coordinates and produces symmetryadapted molecular orbitals.</p>
<p>Only for geometry cleanup the full point group is taken into account. For all other purposes such as the construction of symmetry-adapted molecular orbitals and or to describe electronic states, only D 2 h and subgroups are currently supported. Here the use of symmetry helps to control the calculation and the interpretation of the results.</p>
<h2>2.19.1 Getting started</h2>
<p>Utilization of symmetry is turned on by the simple keyword UseSymmetry (which may be abbreviated by UseSym ), or if a %Symmetry (or %Sym ) input block is present in the input. ORCA will then automatically determine the point group, reorient and center the molecule to align its symmetry elements with the coordinate system, and replace the input structure by a geometry that corresponds exactly to this point group and which minimizes the sum of square distances between the atoms of both structures.</p>
<p>Any program that attempts to find the point group of an arbitrary atom cluster must be prepared to cope with some amount of numerical noise in the atom coordinates. ORCA by default allows each atom to deviate at most 10 -4 atomic units from the ideal position that is consistent with the point group being examined. The rationale behind this value is the rounding error that occurs when the user feeds Cartesian coordinates with five significant digits after the decimal point into the program which otherwise represent an exact (symmetry-adapted) geometry. A threshold that is about one order of magnitude higher than the numerical noise in the coordinates is usually very safe.</p>
<p>If the maximum error in the Cartesian coordinates exceeds these 10 -4 atomic units, the symmetry module in ORCA will fail to recognize the expected point group. The user is strongly advised to always make sure that the detected point group meets their expectations. If the point group reported by the symmetry module appears to be too low, the user may try to increase the detection threshold to 10 -3 or 10 -2 Bohr radii using option SymThresh in the %Symmetry input block:</p>
<pre><code>%Sym SymThresh 0.01 End</code></pre>
<p>A great method to obtain a structure with perfect symmetry avoiding any expensive calculation is to use the simple keywords ! NoIter XYZFile with an appropriate threshold. The structure in the resulting file with the extension .xyz may then be used as input for the actual calculation.</p>
<p>To give an illustrative example, coordinates for staggered ethane have been obtained by geometry optimization without using symmetry. If symmetry is turned on, point group C i is recognized instead of the expected point group D 3 d due to the remaining numerical noise. To counter this, the detection threshold is increased to 10 -2 a. u. and a coordinate file with perfect symmetry is produced by the following input:</p>
<pre><code>! RHF SVP NoIter XYZfile %sym SymThresh 1.0e-2 end *xyz 0 1 C -0.002822 -0.005082 -0.001782 C -0.723141 -1.252323 -0.511551 H 0.017157 0.029421 1.100049</code></pre>
<p>(continues on next page)</p>
<pre><code>H 1.042121 0.030085 -0.350586 H -0.495109 0.917401 -0.350838 H -0.743120 -1.286826 -1.613382 H -0.230855 -2.174806 -0.162495 H -1.768085 -1.287489 -0.162747 *</code></pre>
<p>If ORCA fails to find the expected point group even though a value of 10 -2 atomic units has been selected for SymThresh , the user is strongly advised to take a careful look at the structure by means of their favorite visualization tool before increasing this value any further. Look for any obvious distortions or even missing atoms. An especially tricky point may be the orientation of methyl groups or the conformation of floppy side chains. A small rotation about a single bond may be enough to push some atom positions above the limit. If the conformational deviations cannot be fixed using a molecular editor or modelling program, a possible alternative may be to pre-optimize the structure without symmetry using a less expensive method like PB86 and a small basis set like def2-SVP . Even several passes of pre-optimization and structure editing may be considered until all symmetry-equivalent side chains are locked in the same conformation so that ORCA finally detects the correct point group.</p>
<p>It is not recommended to run calculations using a value of SymThresh which is much too high or much too small since this may result in some really strange behavior of the symmetry module. Consider for instance the following input file which contains a perfectly octahedral geometry of a sulfur hexafluoride molecule. Its coordinates may be easily created by hand by placing the sulfur atom into the origin and two fluorine atoms on each coordinate axis at equal distances r from the origin ( r = 1 . 56 Å or approximately 2 . 95 atomic units). Using a value for SymThresh as large as 0 . 1 Bohr radii works fine in this case, resulting in the correct point group O h .</p>
<pre><code># Sulfur hexafluoride (SF6), point group Oh. ! BP86 def2-SVP %Sym SymThresh 0.1 End * xyz 0 1 S 0.00 0.00 0.00 F 1.56 0.00 0.00 F -1.56 0.00 0.00 F 0.00 1.56 0.00 F 0.00 -1.56 0.00 F 0.00 0.00 1.56 F 0.00 0.00 -1.56 *</code></pre>
<p>However, if SymThresh is increased further to t = 0 . 5 atomic units, the point group detection algorithm breaks down (strange warnings are printed as a consequence) and the reported point group decreases to C i (in which the center of inversion is the only non-trivial symmetry element). This is because the center of inversion is easy to detect and this is done by one of the early checks. The breakdown of the point group recognition may be explained as follows. During the process of point group detection the symmetry module is of course unaware that the given input geometry is exact. Hence it will be treated as any other input structure. A value of t = 0 . 5 Bohr radii for SymThresh means that the unknown exact atom position is located within a sphere of radius t = 0 . 5 atomic units around the input atom position. The input distance a = √ 2 r between two adjacent fluorine atoms is approximately a ≈ 2 . 21 Å ≈ 4 . 17 a. u., so their unknown exact distance d may vary in the following interval (see the diagram in Fig. 2.6):</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Analogously, the unknown exact distance d ′ between two opposite fluorine atoms with the input distance a ′ = 2 r = 5 . 90 a. u. is:</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Since the possible intervals of d and d ′ overlap (due to d max &gt; d ′ min ), all fifteen F-F distances are considered equal. Since there is no solid with six vertices and fifteen equal inter-vertex distances in three dimensions, the point group detection algorithm fails.</p>
<p>(continued from previous page)</p>
<figure><figcaption><div class="caption">Fig. 2.6: The relation between the value t of SymThresh , the distance a of some input atom pair, and the allowed interval [ d min , d max ] for the distance d between the exact atom positions. This interval has the width d max -d min = 4 t .</div></figcaption></figure>
<h2>2.19.2 Geometry optimizations using symmetry</h2>
<p>If a geometry optimization is performed with symmetry turned on, ORCA will first determine the point group of the starting structure and replace the geometry that is presumed to contain numerical noise with one that has perfect symmetry. Starting with ORCA 6, the optimizer will clean up the gradient at every step of the optimization if requested by setting option CleanUpGradient true in the %Symmetry input block. The gradient cleanup is done by projecting out all components that are not totally symmetric. This way the symmetry of the molecule cannot decrease during the optimization.</p>
<p>By default, the point group is determined from scratch again after the geometry has been updated at every step of the optimization. This behaviour may be switched off by setting option SymRelaxOpt false in the %Symmetry input block. In this case the point group of the molecule is actually frozen during the entire optimization.</p>
<p>The following table summarizes the behaviour of the optimizer depending on the options SymRelaxOpt and CleanUpGradient :</p>
<table><tbody><tr><td>SymRelaxOpt</td><td>CleanUpGradient</td><td>Behaviour</td></tr><tr><td>true</td><td>true</td><td>Symmetry may increase but not decrease.</td></tr><tr><td>true</td><td>false</td><td>Symmetry may change freely.</td></tr><tr><td>false</td><td>true</td><td>Symmetry will be frozen.</td></tr><tr><td>false</td><td>false</td><td>Setting not recommended.</td></tr></tbody></table>
<p>Setting both switches false would allow the point group to change during the optimization but at the same time, a change would be impossible to detect. Therefore this setting is strongly discouraged.</p>
<h2>2.19.3 Default alignment of the symmetry elements with the coordinate system</h2>
<p>If ORCA determines the point group of a molecule and the user has not selected any special options, the following principles apply to the manner in which the symmetry elements of the full point group are aligned with the coordinate system:</p>
<ol>
<li style="list-style-type: '1. ';">The center of mass of the molecule will be shifted into the origin by default. 1 If the point group leaves one unique vertex invariant to all symmetry operations, the center of mass agrees with this vertex. This is the case for all point groups except C s , C n ( n ≥ 1) , C nv ( n ≥ 2) , and C ∞ v .</li>
<li style="list-style-type: '2. ';">If the molecule exhibits a unique axis of symmetry with the highest number of positions, this axis will become the z axis. This applies to all point groups except C 1 , C i , C s , D 2 , D 2 h , the cubic point groups, and K h .</li>
<li style="list-style-type: '3. ';">For point group C s , the mirror plane will become the xy plane.</li>
<li style="list-style-type: '4. ';">For point groups C nv ( n ≥ 2) , one of the vertical mirror planes will become the xz plane.</li>
<li style="list-style-type: '5. ';">For point groups D n ( n ≥ 3) , D nh ( n ≥ 3) , and D nd ( n ≥ 2) , one of the two-fold rotation axes perpendicular to the axis with the highest number of positions will become the x axis.</li>
<li style="list-style-type: '6. ';">For point groups D 2 , D 2 h , T , and T h , the three mutually orthogonal C 2 axes will become the coordinate axes.</li>
<li style="list-style-type: '7. ';">For point groups T d , O , and O h , the three mutually orthogonal four-fold rotation or rotation-reflection axes will become the coordinate axes.</li>
<li style="list-style-type: '8. ';">Finally, for point groups I and I h , one of the five sets of three mutually orthogonal C 2 axes will become the coordinate axes. The pair of C 5 or S 10 axes closest to the z axis will be located in the yz plane.</li>
<li style="list-style-type: '9. ';">In general the orientation of the molecule will be changed as little as possible to meet the criteria above. If the input geometry meets these criteria already, the molecule will not be moved or rotated at all.</li>
</ol>
<p>If the point group of the system is D nd with n ≥ 2 or T d and the user has selected subgroup C 2 v using option PreferC2v , the following rules apply instead:</p>
<ul>
<li style="list-style-type: '· ';">For point group D nd with n ≥ 2 , one of the diagonal mirror planes will become the xz plane.</li>
<li style="list-style-type: '· ';">For point group T d , one of the diagonal mirror planes containing the z axis will become the xz plane, i. e. the molecule will be rotated by 45 degrees about the z axis compared to the default orientation.</li>
</ul>
<p>Table 2.63 gives an overview over all point groups and the way in which the symmetry elements of the reduced point group (the largest common subgroup of D 2 h ) are aligned with the coordinate system.</p>
<table><caption><div class="caption">Table 2.63: Point groups and corresponding subgroups suitable for electronic-structure calculations.</div></caption><tbody><tr><th>Full point group</th><th>Index n</th><th>Unique center Page 195, 2</th><th>Consistent with planar molecule Page 195, 3</th><th>Chosen subgroup</th><th>Alignment of the subgroup Page 195, 4</th></tr><tr><td>C 1</td><td></td><td>no</td><td>no</td><td>C 1</td><td></td></tr><tr><td>C i</td><td></td><td>i</td><td>no</td><td>C i</td><td></td></tr><tr><td>C s</td><td></td><td>no</td><td>yes</td><td>C s</td><td></td></tr><tr><td>C n</td><td>odd</td><td>no</td><td>no</td><td>C 1</td><td></td></tr><tr><td></td><td>even</td><td>no</td><td>no</td><td>C 2</td><td>z axis</td></tr><tr><td>C nv</td><td>odd</td><td>no</td><td>no</td><td>C s</td><td>xz plane</td></tr><tr><td></td><td>even</td><td>no</td><td>for n = 2</td><td>C 2 v</td><td>z , xz , yz</td></tr><tr><td>C nh</td><td>odd</td><td>yes</td><td>yes</td><td>C s</td><td>xy plane</td></tr><tr><td></td><td>even</td><td>i</td><td>yes</td><td>C 2 h</td><td>z , xy</td></tr><tr><td>D n</td><td>odd</td><td>yes</td><td>no</td><td>C 2</td><td>x axis</td></tr><tr><td></td><td>even</td><td>yes</td><td>no</td><td>D 2</td><td></td></tr><tr><td>D nh</td><td>odd</td><td>yes</td><td>yes</td><td>C 2 v</td><td>x , xy , xz</td></tr><tr><td></td><td>even</td><td>i</td><td>yes</td><td>D 2 h</td><td></td></tr><tr><td>D nd</td><td>odd</td><td>i</td><td>no</td><td>C 2 h</td><td>x , yz</td></tr><tr><td></td><td>even</td><td>yes</td><td>no</td><td>D 2</td><td></td></tr></tbody></table>
<p>continues on next page</p>
<p>1 In the very special case that the Z matrix contains no atoms with mass, the geometric center will be used instead.</p>
<table><caption><div class="caption">Table 2.63 - continued from previous page</div></caption><tbody><tr><th>Full point group</th><th>Index n</th><th>Unique center 2</th><th>Consistent with planar molecule 3</th><th>Chosen subgroup</th><th>Alignment of the subgroup 4</th></tr><tr><td>S 2 n</td><td>odd even</td><td>i yes</td><td>no no</td><td>C 2 v C i C 2</td><td>z , xz , yz z axis</td></tr><tr><td>T</td><td></td><td>yes</td><td>no</td><td>D 2</td><td></td></tr><tr><td>T h</td><td></td><td>i</td><td>no</td><td>D 2 h</td><td></td></tr><tr><td>T d</td><td></td><td>yes</td><td>no</td><td>D 2 C 2 v</td><td>z , xz , yz</td></tr><tr><td>O</td><td></td><td>yes</td><td>no</td><td>D 2</td><td></td></tr><tr><td>O h</td><td></td><td>i</td><td>no</td><td>D 2 h</td><td></td></tr><tr><td>I</td><td></td><td>yes</td><td>no</td><td>D 2</td><td></td></tr><tr><td>I h</td><td></td><td>i</td><td>no</td><td>D 2 h</td><td></td></tr><tr><td>C ∞ v</td><td></td><td>no</td><td>no</td><td>C 2 v</td><td>z , xz , yz</td></tr><tr><td>D ∞ h</td><td></td><td>i</td><td>no</td><td>D 2 h</td><td></td></tr><tr><td>K h</td><td></td><td>i</td><td>no</td><td>D 2 h</td><td></td></tr></tbody></table>
<h2>2.19.4 Irreducible representations of D 2 h and subgroups</h2>
<p>Table 2.64, Table 2.65, and Table 2.66 contain lists of the irreducible representations (also called species) and the corresponding characters of the point groups supported for electronic structure calculations in ORCA, and the product tables of these irreducible representations. Where the data depends on the alignment of the symmetry elements with the coordinate system, Mulliken's recommendations [176] are followed. This approach is in line with the recommendations by the IUPAC [177].</p>
<table><caption><div class="caption">Table 2.64: Species and species product table of point group C 2 v . The species table for C 2 v corresponds to Table III in [176]. The directions of the two-fold axis and the mirror planes in each column are related to each other by cyclic permutations.</div></caption><tbody><tr><th rowspan="2">C 2 v</th><th rowspan="2">E</th><th rowspan="2">C 2 ( z ) C 2 ( x ) C 2 ( y )</th><th rowspan="2">σ v ( xz ) σ v ( xy ) σ v ( yz )</th><th rowspan="2">σ v ( yz ) σ v ( xz ) σ v ( xy ) ×</th><th rowspan="2">A 1</th><th rowspan="2">A 2</th><th rowspan="2">B 1</th><th rowspan="2">B 2</th></tr><tr><td>A 1</td><td>+1</td><td>+1</td><td>+1</td><td>A 1</td><td>A 1</td><td>A 2</td><td>B 1</td><td>B 2</td></tr><tr><td>A 2</td><td>+1</td><td>+1</td><td>- 1</td><td>A 2</td><td>A 2</td><td>A 1</td><td>B 2</td><td>B 1</td></tr><tr><td>B 1</td><td>+1</td><td>- 1</td><td>+1</td><td>B 1</td><td>B 1</td><td>B 2</td><td>A 1</td><td>A 2</td></tr><tr><td>B 2</td><td>+1</td><td>- 1</td><td>- 1</td><td>B 2</td><td>B 2</td><td>B 1</td><td>A 2</td><td>A 1</td></tr></tbody></table>
<table><caption><div class="caption">Table 2.65: Species and species product table of point group D 2 . The species table for D 2 has been obtained by dropping the center of inversion and the mirror planes from the species table for D 2 h (see Table 2.66).</div></caption><tbody><tr><th>D 2</th><th>E</th><th>C 2 ( z )</th><th>C 2 ( y )</th><th>C 2 ( x )</th><th>×</th><th>A</th><th>B 1</th><th>B 2</th><th>B 3</th></tr><tr><td>A</td><td>+1</td><td>+1</td><td>+1</td><td>+1</td><td>A</td><td>A</td><td>B 1</td><td>B 2</td><td>B 3</td></tr><tr><td>B 1</td><td>+1</td><td>+1</td><td>- 1</td><td>- 1</td><td>B 1</td><td>B 1</td><td>A</td><td>B 3</td><td>B 2</td></tr><tr><td>B 2</td><td>+1</td><td>- 1</td><td>+1</td><td>- 1</td><td>B 2</td><td>B 2</td><td>B 3</td><td>A</td><td>B 1</td></tr><tr><td>B 3</td><td>+1</td><td>- 1</td><td>- 1</td><td>+1</td><td>B 3</td><td>B 3</td><td>B 2</td><td>B 1</td><td>A</td></tr></tbody></table>
<p>2 A center of inversion is denoted i . 'yes' indicates the existence of a unique vertex that remains invariant to all symmetry operations of the point group.</p>
<p>3 This column indicates whether the given point group may be the full point group of a planar molecule.</p>
<p>4 This column contains the elements (axes or planes) of the coordinate system that coincide with the symmetry elements of the reduced point group (the largest common subgroup of the full point group and D 2 h ) by default . If the full point group contains a unique principle axis of symmetry (with the highest number of positions), this axis is presumed to coincide with the z axis.</p>
<p>Table 2.66: Species and species product table of point group D 2 h . The species table for D 2 h corresponds to Table IV in [176].</p>
<table><tbody><tr><td>D 2 h</td><td>E</td><td>C 2 ( z )</td><td>C 2 ( y )</td><td>C 2 ( x )</td><td>i</td><td>σ ( xy )</td><td>σ ( xz )</td><td>σ ( yz )</td></tr><tr><td>A g</td><td>+1</td><td>+1</td><td>+1</td><td>+1</td><td>+1</td><td>+1</td><td>+1</td><td>+1</td></tr><tr><td>B 1 g</td><td>+1</td><td>+1</td><td>- 1</td><td>- 1</td><td>+1</td><td>+1</td><td>- 1</td><td>- 1</td></tr><tr><td>B 2 g</td><td>+1</td><td>- 1</td><td>+1</td><td>- 1</td><td>+1</td><td>- 1</td><td>+1</td><td>- 1</td></tr><tr><td>B 3 g</td><td>+1</td><td>- 1</td><td>- 1</td><td>+1</td><td>+1</td><td>- 1</td><td>- 1</td><td>+1</td></tr><tr><td>A u</td><td>+1</td><td>+1</td><td>+1</td><td>+1</td><td>- 1</td><td>- 1</td><td>- 1</td><td>- 1</td></tr><tr><td>B 1 u</td><td>+1</td><td>+1</td><td>- 1</td><td>- 1</td><td>- 1</td><td>- 1</td><td>+1</td><td>+1</td></tr><tr><td>B 2 u</td><td>+1</td><td>- 1</td><td>+1</td><td>- 1</td><td>- 1</td><td>+1</td><td>- 1</td><td>+1</td></tr><tr><td>B 3 u</td><td>+1</td><td>- 1</td><td>- 1</td><td>+1</td><td>- 1</td><td>+1</td><td>+1</td><td>- 1</td></tr><tr><td></td><td>×</td><td>A g</td><td>B 1 g B 2</td><td>g B 3 g</td><td>A u</td><td>B 1 u</td><td>B 2 u</td><td>B 3 u</td></tr><tr><td></td><td>A g</td><td>A g</td><td>B 1 g B 2</td><td>g B 3 g</td><td>A u</td><td>B 1 u</td><td>B 2 u</td><td>B 3 u</td></tr><tr><td></td><td>B 1 g</td><td>B 1 g</td><td>A g B 3</td><td>g B 2 g</td><td>B 1 u</td><td>A u</td><td>B 3 u</td><td>B 2 u</td></tr><tr><td></td><td>B 2 g</td><td>B 2 g</td><td>B 3 g A g</td><td>B 1 g</td><td>B 2 u</td><td>B 3 u</td><td>A u</td><td>B 1 u</td></tr><tr><td></td><td>B 3 g</td><td>B 3 g</td><td>B 2 g B 1</td><td>g A g</td><td>B 3 u</td><td>B 2 u</td><td>B 1 u</td><td>A u</td></tr><tr><td></td><td>A u</td><td>A u</td><td>B 1 u B 2</td><td>u B 3 u</td><td>A g</td><td>B 1 g</td><td>B 2 g</td><td>B 3 g</td></tr><tr><td></td><td>B 1 u</td><td>B 1 u</td><td>A u B 3</td><td>u B 2 u</td><td>B 1 g</td><td>A g</td><td>B 3 g</td><td>B 2 u</td></tr><tr><td></td><td>B 2 u</td><td>B 2 u</td><td>B 3 u A u</td><td>B 1 u</td><td>B 2 g</td><td>B 3 g</td><td>A g</td><td>B 1 u</td></tr><tr><td></td><td>B 3 u</td><td>B 3 u</td><td>B 2 u B 1</td><td>u A u</td><td>B 3 g</td><td>B 2 g</td><td>B 1 g</td><td>A g</td></tr></tbody></table>
<h2>2.19.5 Options available in the %Symmetry input block</h2>
<p>Table 2.67 contains a list of the options available in the %Symmetry (or %Sym ) input block. Options SymThresh and SymRelax (same as SymRelaxSCF below) can also be accessed in the %Method input block for backward compatibility. This use is deprecated and not recommended in new input files, however.</p>
<table><caption><div class="caption">Table 2.67: List of options in the %Symmetry ( %Sym ) input block</div></caption><tbody><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr><tr><td>UseSymmetry</td><td>Boolean</td><td>True</td><td>By setting this option to False , symmetry may be switched off even though the %Symmetry block is present in the input file.</td></tr><tr><td>UseSym</td><td>Boolean</td><td>True</td><td>Same as UseSymmetry .</td></tr><tr><td>SymThresh</td><td>Real</td><td>10 - 4</td><td>Two vertices with a distance shorter than this threshold (in atomic units) are considered identical during point group recognition.</td></tr><tr><td>PreferC2v</td><td>Boolean</td><td>False</td><td>Indicates whether to prefer subgroup C 2 v over D 2 for electronic-structure calculations where both choices are ap- propriate (point groups D nd with odd n and T d ).</td></tr><tr><td>PointGroup</td><td>String</td><td>Empty string</td><td>If the user specifies a point group using this option, point group recognition will be skipped and the user must make sure that the molecule is oriented in the coordinate system in agreement with the conventions in Default alignment of the symmetry elements with the coordinate system . Note that the point group label must be enclosed in double quotes. Other- wise ORCA will complain about an invalid assignment.</td></tr><tr><td>SymRelaxSCF</td><td>Boolean</td><td>False</td><td>Indicates whether orbital occupation numbers of each irre- ducible representation are allowed to change during SCF.</td></tr><tr><td>SymRelaxOpt</td><td>Boolean</td><td>True</td><td>Indicates whether the point group will be determined from scratch in every step of a geometry optimization. A value of True will allow the point group to change in an arbitrary manner. Otherwise the initial point group will be imposed at every step no matter howfar the distances between the current and the ideal structure exceed SymThresh .</td></tr></tbody></table>
<p>continues on next page</p>
<table><caption><div class="caption">Table 2.67 - continued from previous page</div></caption><tbody><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr><tr><td>CleanUpCoords</td><td>Boolean</td><td>True</td><td>Determines whether the molecular geometry will be cleaned up using the automatically detected or user-specified point group. Even if CleanUpCoords is False , symmetrized coordinates will still be computed temporarily and a warn- ing will be printed if the largest deviation from the original geometry exceeds SymThresh .</td></tr><tr><td>CleanUpGeom CleanUpGrad</td><td>Boolean Boolean</td><td>True True</td><td>Same as CleanUpCoords . Indicates whether the full point group of the molecule shall be used to remove all non-totally symmetric components</td></tr><tr><td>CleanUpGradient Print</td><td>Integer</td><td>1</td><td>from the gradient. This ensures that the point group will not de- crease throughout the optimization. Same as CleanUpGrad .</td></tr><tr><td></td><td>Boolean</td><td>True</td><td>Determines the output size for symmetry handling in general and point group detection in particular; 0 - No output dur- ing point group detection; 1 - Normal output; 2 - Detailed information; 3 - Debug print.</td></tr><tr><td>PrtSALC</td><td>Integer</td><td>0</td><td>Specifies the output size for the construction of symmetry- adapted linear combinations (SALCs) of atomic orbitals; 0 - Nooutput for symmetry-adapted orbitals; 1 - Normal output; 2 - Detailed information (e. g. the SALCs themselves); 3 - Debug print.</td></tr></tbody></table>
<h2>2.20 Choice of Initial Guess and Restart of SCF Calculations</h2>
<p>The initial guess is an important issue in each SCF calculation. If this guess is reasonable, the convergence of the procedure will be much better. ORCA makes some effort to provide a good initial guess and gives the user enough flexibility to tailor the initial guess to his or her needs.</p>
<p>The initial guess is also controlled via the %scf block and the variables Guess , MOInp and GuessMode .</p>
<table><tbody><tr><th colspan="3">%scf</th></tr><tr><td>Guess</td><td>HCore Hueckel PAtom PModel</td><td># One electron matrix # Extended H\&quot;uckel guess # Polarized atomic densities # Model potential</td></tr><tr><td>MOInp GuessMode</td><td>MORead &quot;Name.gbw&quot; FMatrix CMatrix</td><td># Restart from an earlier calc. # orbitals used for MORead # FMatrix projection # Corresponding orbital projection # try to use the orbitals from the existing</td></tr><tr><td>AutoStart</td><td>true</td><td># GBW file of the same name (if possible) # (default)</td></tr><tr><td>end</td><td>false</td><td># don&#x27;t use orbitals from existing GBW file</td></tr></tbody></table>
<h2>2.20.1 One Electron Matrix Guess</h2>
<p>The simplest guess is to diagonalize the one electron matrix to obtain starting orbitals. This guess is very simple but usually also a disaster because it produces orbitals that are far too compact.</p>
<h2>2.20.2 Basis Set Projection</h2>
<p>The remaining guesses (may) need the projection of initial guess orbitals onto the actual basis set. In ORCA there are two ways this can be done. GuessMode FMatrix and GuessMode CMatrix . The results from the two methods are usually rather similar. In certain cases GuessMode CMatrix may be preferable. GuessMode FMatrix is simpler and faster. In short the FMatrix projection defines an effective one electron operator:</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>where the sum is over all orbitals of the initial guess orbital set, a † p is the creation operator for an electron in guess MO p , a p is the corresponding annihilation operator and ε i is the orbital energy. This effective one electron operator is diagonalized in the actual basis and the eigenvectors are the initial guess orbitals in the target basis. For most wavefunctions this produces a fairly reasonable guess.</p>
<p>CMatrix is more involved. It uses the theory of corresponding orbitals to fit each MO subspace (occupied, partially occupied or spin-up and spin-down occupied) separately [178, 179]. After fitting the occupied orbitals, the virtual starting orbitals are chosen in the orthogonal complement of the occupied orbitals. In some cases, especially when restarting ROHF calculations, this may be an advantage. Otherwise, it is not expected that CMatrix will be grossly superior to FMatrix for most cases.</p>
<h2>2.20.3 PModel Guess</h2>
<p>The PModel guess (chosen by Guess PModel in the %scf block or simply a keyword line with !PModel ) is one that is usually considerably successful. It consists of building and diagonalizing a Kohn-Sham matrix with an electron density which consists of the superposition of spherical neutral atoms densities which are predetermined for both relativistic and nonrelativistic methods. This guess is valid for both Hartree-Fock and DFT methods, but not for semiempirical models. However, due to the complexity of the guess it will also take a little computer time (usually less than one SCF iteration). The model densities are available for most atoms of the periodic table and consequently the PModel guess is usually the method of choice (particularly for molecules containing heavy elements) unless you have more accurate starting orbitals available.</p>
<h2>2.20.4 Hückel and PAtom Guesses</h2>
<p>The extended Hückel guess proceeds by performing a minimal basis extended Hückel calculation and projecting the MOs from this calculation onto the actual basis set using one of the two methods described above. The minimal basis is the STO-3G basis set. The Hückel guess may not be very good because the STO-3G basis set is so poor. There is also accumulating evidence that the superposition of atomic densities produces a fairly good initial guess. The critique of the atomic density method is that the actual shape of the molecule is not taken into account and it is more difficult to reliably define singly occupied orbitals for ROHF calculations or a reasonable spin density for UHF calculations. Therefore ORCA chooses a different way in the PAtom guess (which is the default guess): the Hückel calculation is simply carried out for all electrons in a minimal basis of atomic SCF orbitals. These were determined once and for all and are stored inside the program. This means that the densities around the atoms are very close to the atomic ones, all orbitals on one center are exactly orthogonal, the initial electron distribution already reflects the molecular shape and there are well defined singly occupied orbitals for ROHF calculations.</p>
<h2>2.20.5 Restarting SCF Calculations</h2>
<p>To restart SCF calculations, it can be very helpful and time-saving to read in the orbital information of a previous calculation. To do this, specify:</p>
<pre><code>! moread %moinp "name.gbw"</code></pre>
<p>This is done by default for single-point calculations if the .gbw file of the same name exists - see AutoStart feature .</p>
<p>The program stores the current orbitals in every SCF cycle. Should a job crash, it can be restarted from the orbitals that were present at this time by just re-running the calculation to use the present .gbw file. In addition, an effort has been made to make .gbw files from different releases compatible with each other. If your input .gbw file is from an older release, use ! rescue moread noiter with % moinp "name.gbw" to produce an up-todate .gbw . When the rescue keyword is invoked, only the orbital coefficients are read from the .gbw file, and everything else from the input file. Thus, make sure that the geometry and the basis set of the old .gbw file and the new input match.</p>
<p>Within the same ORCA version, neither the geometry nor the basis set stored in name.gbw need to match the present geometry or basis set. The program merely checks if the molecules found in the current calculation and name.gbw are consistent with each other and then performs one of the possible orbital projections. If the two basis sets are identical the program by default only reorthogonalizes and renormalizes the input orbitals. However, this can be overruled by explicitly specifying GuessMode in the % scf block as CMatrix or FMatrix .</p>
<p>If redundant components were removed from the basis (see Linear Dependence ), then ! moread noiter must not be used to read SCF orbitals from a previous calculation, as it is going to lead to wrong results. In that case, ! moread may be used (without noiter ) if doing the entire calculation in one go is not possible.</p>
<p>If !moread and %moinp are used, the input .gbw file from the earlier calculation must have a different name than the new calculation, because in the very beginning of a calculation, a new .gbw file is written. If the names are the same, the .gbw file from the earlier calculation is overwritten and all information is lost. Therefore, if you want to restart a calculation with an input file of the same name as the previous calculation, you have to rename the .gbw file first. This is good practice anyway to avoid surprises, particularly for expensive calculations. Alternatively, you can use the AutoStart feature instead of explicitly specifying !moread and %moinp .</p>
<p>There is an additional aspect of restarting SCF calculations - if you have chosen SCFMode = Conventional the program stores a large number of integrals that might have been time consuming to calculate on disk. Normally the program deletes these integrals at the end of the calculation. However, if you want to do a closely related calculation that requires the same integrals (i.e. the geometry , the basis set and the threshold Thresh are the same) it is faster to use the integrals generated previously. This is done by using KeepInts = true in the % scf block of the first calculation and then use ReadInts = true in the % scf block of the second calculation. If the second calculation has a different name than the first calculation you have to use IntName = "FirstName" to tell the program the name of the integral files. Note that the file containing the integrals does not have an extension - it is simply the name of the previous input file with .inp stripped off.</p>
<pre><code>%scf KeepInts true # Keep integrals on disk ReadInts true # Read integrals from disk IntName "MyInts" # Name of the integral files without extension end</code></pre>
<p>Note that, in general, restarting calculations with old integral files requires the awareness and responsibility of the user. If properly used, this feature can save considerable amounts of time.</p>
<h2>2.20.6 AutoStart feature</h2>
<p>Older versions of ORCA always created a new GBW file at the beginning of the run no matter whether a file of the same name existed or perhaps contained orbitals. Now, in the case of single-point calculations the program automatically checks if a .gbw file of the same name exists. If yes, the program checks if it contains orbitals and all other necessary information for a restart. If yes, the variable Guess is set to MORead . The existing .gbw file is renamed to BaseName.ges and MOInp is set to this filename. If the AutoStart feature is not desired, set AutoStart false in the %scf block or give the keyword !NoAutoStart in the simple input line. Note that AutoStart is ignored for geometry optimizations: in this case, using previously converged orbitals contained in a .gbw file (of a different name) can be achieved via MORead and MOInp .</p>
<h2>2.20.7 Changing the Order of Initial Guess MOs and Breaking the Initial Guess Symmetry</h2>
<p>Occasionally you will want to change the order of initial guess MOs - be it because the initial guess yielded an erroneous occupation pattern or because you want to converge to a different electronic state using the orbitals of a previous calculation. Reordering of MOs and other tasks (like breaking the symmetry of the electronic wavefunction) are conveniently handled with the Rotate feature in ORCA. Rotate is a subblock of the SCF block that allows you to linearly transform pairs of MOs.</p>
<pre><code>%scf Rotate { MO1, MO2, Angle } { MO1, MO2, Angle, Operator1, Operator2 } { MO1, MO2} # Shortcut to swap MO1 and MO2. Angle=90 degrees. end end</code></pre>
<p>Here, MO1 and MO2 are the indices of the two MOs of interest. Recall that ORCA starts counting MOs with index 0, i.e. the MO with index 1 is the second MO. Angle is the rotation angle in degrees. A rotation angle of 90 ◦ corresponds to flipping two MOs, an angle of 45 ◦ leads to a 50:50 mixture of two MOs, and a 180 ◦ rotation leads to a change of phase. Operator1 and Operator2 are the orbitals sets for the rotation. For UHF calculations spin-up orbitals belong to operator 0 and spin-down orbitals to operator 1. RHF and ROHF calculations only have a single orbital set.</p>
<p>Among others, the Rotate feature can be used to produce broken-symmetry solutions, for example in transition metal dimers. In order to do that, first perform a high-spin calculation, then find the pairs of MOs that are symmetric and antisymmetric combinations of each other. Take these MOs as the initial guess and use rotations of 45 ◦ for each pair to localize the starting MOs. If you are lucky and the broken symmetry solution exists, you have a good chance of finding it this way. See section Broken-Symmetry Wavefunctions and Exchange Couplings for more details on the broken-symmetry approach.</p>
<h2>2.20.8 Automatically Breaking of the Initial Guess Symmetry</h2>
<p>Another simple way to break the initial guess symmetry for more trivial cases, is to simply use the keyword ! GUESSMIX . This will automatically mix 50% of the alpha LUMO into the alpha HOMO. That is equivalent to a 45 degree rotation as done above and only for these orbitals. It might be useful when one wants an open-shell singlet and needs the alpha and beta orbitals to start differently.</p>
<p>The specific angle of rotation can be controlled with:</p>
<pre><code>%scf guessmix 75 # angle in degrees, default is 45 end</code></pre>
<h2>2.20.9 Calculating only the energy of an input density</h2>
<p>In case you want to give the result of a previous SCF and recalculate the energy, or maybe some other property (like the MP2 energy) using that density without changing the orbitals, you can use the flags !CALCGUESSENERGY NOITER .</p>
<p>The SCF program will read the orbitals, compute the density and one Fock matrix necessary to get the energy and move on with no orbital updates. This can be used to combine DFT orbitals with DLPNO-CCSD(T) for example. Be careful with the results you get from this because these orbitals are not variational anymore!</p>
<h2>2.20.10 Keywords</h2>
<table><caption><div class="caption">Table 2.68: Simple input keywords related to the initial guess.</div></caption><tbody><tr><th>Keyword</th><th>Description</th></tr><tr><td>PAtom</td><td>Selects the polarized atoms guess</td></tr><tr><td>PModel</td><td>Selects the model potential guess</td></tr><tr><td>Hueckel</td><td>Selects the extended Hückel guess</td></tr><tr><td>HCore</td><td>Selects the one-electron matrix guess</td></tr><tr><td>MORead</td><td>Read MOs from a previous calculation (use together with %moinp &quot;myorbitals.gbw&quot; )</td></tr><tr><td>AutoStart</td><td>Try to start from an existing GBWfile of the same name as the present one (default; only for single-point calculations)</td></tr><tr><td>NoAutoStart</td><td>Don&#x27;t try to do that</td></tr><tr><td>NoIter</td><td>Sets the number of SCF iterations to 0. This works together with MOREADandmeans that the program will work with the provided starting orbitals.</td></tr><tr><td>KeepInts</td><td>Do not delete the integrals from disk after a calculation in conventional mode</td></tr><tr><td>ReadInts</td><td>Read the existing integrals from a previous calculation in conventional mode (use together with %scf IntName &quot;PreviousBaseName&quot; end )</td></tr><tr><td>CalcGuessEnergy</td><td>Calculate the energy of the initial guess orbitals (use together with NoIter )</td></tr></tbody></table>
<h2>2.21 Frozen Core Options</h2>
<p>The frozen core (FC) approximation is usually applied in correlated calculation and consists in neglecting correlation effects for electrons in the low-lying core orbitals. The FC approximation and the number of core electrons per element can be adjusted in the %method block. The default number of core electrons per element is listed in Table 2.69.</p>
<p>Table 2.69: Default values for number of frozen core electrons.</p>
<table><tbody><tr><th>H</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><th>0</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><th>Li</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><th>B</th><th>C</th><th>N</th><th>O</th><th>F</th><th colspan="3">Ne</th></tr><tr><td></td><th>Be</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><th>0 Na</th><th>0 Mg</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><th>2 Al</th><th>2 Si</th><th>2 P</th><th>2 S</th><th>2 Cl</th><th colspan="3">Ar</th></tr><tr><th>2</th><th>2</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><th>10</th><th>10</th><th colspan="3">10</th></tr><tr><th>K</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><th>10</th><th>10</th><th>10</th><td></td><th>Br</th><td></td><td></td><td></td></tr><tr><th>10</th><th>Ca 10</th><th>Sc 10</th><th>Ti 10</th><th>V Cr 10 10</th><th>Mn 10</th><th>Fe 10</th><th>Co 10</th><th>Ni</th><th>Cu</th><th>Zn</th><th>Ga</th><th>Ge</th><th>As</th><th>Se 18</th><th>18</th><th colspan="3">18</th></tr><tr><th>Rb</th><th>Sr</th><th>Y</th><th>Zr</th><th>Nb</th><td></td><td></td><td></td><th>10</th><th>10</th><th>10</th><th>18</th><th>18</th><th>18</th><td></td><th>I</th><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><th>Mo</th><th>Tc Ru</th><th>Rh</th><th>Pd</th><th>Ag</th><th>Cd</th><th>In</th><th>Sn</th><th>Sb</th><th>Te</th><td></td><th colspan="3">Xe</th></tr><tr><th>18</th><th>18</th><th>28</th><th>28</th><th>28</th><th>28</th><th>28 28</th><th>28</th><th>28</th><th>28</th><th>28</th><th>36</th><th>36</th><th>36</th><th>36</th><th>36</th><th colspan="3">36</th></tr><tr><th>Cs</th><th>Ba</th><th>Lu</th><th>Hf</th><th>Ta</th><th>W</th><th>Re Os</th><th>Ir</th><th>Pt</th><th>Au</th><th>Hg</th><th>Tl</th><th>Pb</th><th>Bi</th><th>Po</th><th>At</th><th colspan="3">Rn</th></tr><tr><th>36</th><th>36</th><th>46</th><th>46</th><th>46</th><th>46</th><td></td><th>46</th><th>46</th><th>46</th><th>46</th><th>68</th><th>68</th><th>68</th><td></td><th>68</th><th colspan="3">68</th></tr><tr><td></td><td></td><th>68</th><th>100</th><th>100</th><td></td><th>100</th><td></td><th>100</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><th>68</th><th>68</th><td></td><td></td><td></td><th>100</th><td></td><td></td><td></td><th>100</th><th>100</th><td></td><td></td><td></td><td></td><th>Yb</th><td></td><td></td><td></td></tr><tr><th>Lan- thanides</th><td></td><td></td><th>La</th><th>Ce Pr</th><td>Nd</td><td></td><th>Pm 36</th><td></td><th>Gd</th><th>Tb</th><td></td><th>Ho 36</th><th>36</th><td>Tm</td><th>36</th><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><th>36</th><th>36</th><th>36</th><th>36</th><th>36</th><th>36</th><th>36</th><th>36</th><td></td><td></td><th>36</th><td></td><td></td><td></td><td></td></tr><tr><th>Ac-</th><td></td><th>Ac</th><td></td><th>Th</th><th>Pa U</th><td></td><td></td><th>Am</th><th>Cm</th><th>Bk</th><th>Cf</th><th>Es</th><td></td><th>Md</th><td></td><th colspan="3">No</th></tr><tr><td></td><td></td><td></td><th>68</th><th>68</th><td></td><td></td><td></td><th>68</th><th>68</th><th>68</th><th>68</th><th>68</th><th>68</th><th>68</th><th>68</th><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><th>68</th><th>68</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><th>68</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><th>68</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><th>tinides</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><th>Pu</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><th>Np</th><td></td><td></td><td></td><td></td><td></td><th>Fm</th><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><th>100</th><th>Sm</th><td></td><td></td><td></td><td></td><th>Dy</th><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><th>Fr</th><td></td><td></td><td></td><th>Db</th><th>Sg</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><th>100</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><th>36</th><td></td><td></td><td></td><th>Mt</th><td></td><td></td><td></td><td></td><td></td><th>Er</th><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><th>46</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><th>Eu</th><td></td><th>Cn</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><th>Lr</th><td></td><td></td><td></td><th>Bh</th><th>Hs</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><th>Ra</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><th>Rg</th><td></td><td></td><td></td><td></td><th>68</th><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><th>46</th><th colspan="11">Ds</th></tr><tr><td></td><td></td><td></td><th>Rf</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table>
<p>For systems containing heavy elements, core electrons might have higher orbital energies compared to the orbital energies of valence MOs of some lighter elements. In that case, core electrons might be included in the correlation calculation, which ultimately leads to large errors in correlation energy. In order to prevent this, the MO ordering is checked: Do all lower energy MOs in the core region have core electron character, i.e. are they strongly localized on the individual elements? For post-(CAS)SCF calulations, this check is always performed both after the SCF calculation, and after the initial guess (because the SCF may be skipped with !NoIter ). For other calculations, the check is off by default but may be switched on with the CheckFrozenCore keyword in the %method block. If core orbitals are found in the valence region, while more delocalized orbitals are found in the core region, the corresponding MO pairs are swapped. This behavior can be disabled using the CorrectFrozenCore keyword.</p>
<pre><code>%method FrozenCore FC_ELECTRONS #Freeze all core electrons FC_EWIN #Freeze selected core electrons via an energy window #e.g. for MP2: %mp2 EWin EMin,EMax FC_NONE #No frozencore approximation -n #Freeze a total of n electrons NewNCore Bi 68 end #Set the number of core electrons for Bi to 68 CheckFrozenCore true #Check whether frozen core orbitals are ordered correctly #Default: true only for post-(CAS)SCF calculations CorrectFrozenCore true #Whether to rotate valence orbitals out of the core␣ ↪ → region end</code></pre>
</div>
</body>
</html>