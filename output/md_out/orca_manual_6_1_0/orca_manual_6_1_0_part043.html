<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<title>orca_manual_6_1_0_part043</title>
<meta name="generator" content="Docling HTML Serializer"/>
<style>
    html {
        background-color: #f5f5f5;
        font-family: Arial, sans-serif;
        line-height: 1.6;
    }
    body {
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem;
        background-color: white;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1, h2, h3, h4, h5, h6 {
        color: #333;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    h1 {
        font-size: 2em;
        border-bottom: 1px solid #eee;
        padding-bottom: 0.3em;
    }
    table {
        border-collapse: collapse;
        margin: 1em 0;
        width: 100%;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
    }
    th {
        background-color: #f2f2f2;
        font-weight: bold;
    }
    figure {
        margin: 1.5em 0;
        text-align: center;
    }
    figcaption {
        color: #666;
        font-style: italic;
        margin-top: 0.5em;
    }
    img {
        max-width: 100%;
        height: auto;
    }
    pre {
        background-color: #f6f8fa;
        border-radius: 3px;
        padding: 1em;
        overflow: auto;
    }
    code {
        font-family: monospace;
        background-color: #f6f8fa;
        padding: 0.2em 0.4em;
        border-radius: 3px;
    }
    pre code {
        background-color: transparent;
        padding: 0;
    }
    .formula {
        text-align: center;
        padding: 0.5em;
        margin: 1em 0;
        background-color: #f9f9f9;
    }
    .formula-not-decoded {
        text-align: center;
        padding: 0.5em;
        margin: 1em 0;
        background: repeating-linear-gradient(
            45deg,
            #f0f0f0,
            #f0f0f0 10px,
            #f9f9f9 10px,
            #f9f9f9 20px
        );
    }
    .page-break {
        page-break-after: always;
        border-top: 1px dashed #ccc;
        margin: 2em 0;
    }
    .key-value-region {
        background-color: #f9f9f9;
        padding: 1em;
        border-radius: 4px;
        margin: 1em 0;
    }
    .key-value-region dt {
        font-weight: bold;
    }
    .key-value-region dd {
        margin-left: 1em;
        margin-bottom: 0.5em;
    }
    .form-container {
        border: 1px solid #ddd;
        padding: 1em;
        border-radius: 4px;
        margin: 1em 0;
    }
    .form-item {
        margin-bottom: 0.5em;
    }
    .image-classification {
        font-size: 0.9em;
        color: #666;
        margin-top: 0.5em;
    }
</style>
</head>
<body>
<div class='page'>
<h2>5.6.8 Simplified TDA and TD-DFT</h2>
<p>ORCA also supports calculations of excited states using the simplified Tamm-Dancoff approach (sTDA) by S. Grimme[633]. The sTDA is particularly suited to calculate absorption spectra of very large systems. sTDA as well as the simplified time-dependent density functional theory (sTD-DFT)[634] approach require a (hybrid) DFT ground state calculation. For large systems, using range-separated hybrid functionals (e.g. ω B97X) is recommended.[635] The sTD-DFT approach in particular yields much better electronic circular dichroism (ECD) spectra and should be used for this purpose.</p>
<h2>Theoretical Background</h2>
<p>A brief outline of the theory will be given in the following. For more details, please refer to the original papers[633, 634]. In the sTDA, the TDA eigenvalue problem from eq. (5.67) is solved using a truncated and semi-empirically simplified A ′ matrix. The trunctation negelects all excitations that are beyond the energy range of interest, except a few strongly coupled ones. The matrix elements from eq. (5.68) are simplified by neglecting the response of the density functional and by approximating the remaining two-electron integrals as damped Coulomb interactions between transition/charge density monopoles. In the following, the indices i, j denote occupied, a, b virtual and p, q either kind of orbitals.</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>q A pq and q B pq are the transition/charge density monopoles located on atom A and B , respectively. These are obtained from Löwdin population analysis (see Sec. Löwdin Population Analysis ). ϵ p is the Kohn-Sham orbital energy of orbital p . γ K AB and γ J AB are the Mataga-Nishimoto-Ohno-Klopman damped Coulomb operators for exchange-type ( K ) and Coulomb-type ( J ) integrals, respectively.</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<p>Here, η is the arithmetic mean of the chemical hardness of atom A and B . α and β are the parameters of the method and are given by:</p>
<div class="formula-not-decoded">Formula not decoded</div>
<div class="formula-not-decoded">Formula not decoded</div>
<p>For any global hybrid functional, α 1 , α 2 , β 1 and β 2 are identical. α and β then depend on the amount of Fock exchange ( a X) only. This is different for range-separated hybrid functionals where α 2 and β 2 are set to zero. α 1 and β 1 along with a value a x for the sTDA treatment are individually fitted for each range-separated hybrid functional.[635] It can bee seen from eq. (5.73) that the method is asymptotically correct which is crucial for excitations of charge transfer type.</p>
<p>In sTD-DFT, eq. (5.66) is solved using the simplified matrices A ′ (see above) and B ′ .</p>
<div class="formula-not-decoded">Formula not decoded</div>
<p>This approach yields better transition dipole moments and therefore spectra but the method is more costly than sTDA (a factor of 2-5 for typical systems). The parameters used in sTDA and sTD-DFT are identical. There are no additional parameters fitted for this method.</p>
<h2>Calculation Set-up</h2>
<p>sTDA and sTD-DFT can be combined with any (restricted or unrestricted) hybrid DFT singlepoint calculation. Gradients and frequencies are not implemented! The methods can be invoked via the %tddft block. Table Keyword list for sTDA and sTD-DFT. gives a list of the possible keywords.</p>
<table><caption><div class="caption">Table 5.6: Keyword list for sTDA and sTD-DFT.</div></caption><tbody><tr><td>Mode sTDA</td><td>Invokes a sTDA calculation</td></tr><tr><td>Mode sTDDFT</td><td>Invokes a sTD-DFT calculation</td></tr><tr><td>EThresh value</td><td>Energy threshold up to which CSFs are included (in eV)</td></tr><tr><td>PTLimit value</td><td>Energy threshold up to which CSFs beyond EThresh may be selected (in eV)</td></tr><tr><td>PThresh value</td><td>Selection criterion to include CSF beyond EThresh (in Eh)</td></tr><tr><td>axstda value</td><td>Fock exchange parameter used in sTDA/sTD-DFT calculation (for range-separated hybrids)</td></tr><tr><td>beta1 value</td><td>Constant part of J integral parameter β</td></tr><tr><td>beta2 value</td><td>a X scaled part of J integral parameter β</td></tr><tr><td>alpha1 value</td><td>Constant part of K integral parameter α</td></tr><tr><td>alpha2 value</td><td>a X scaled part of K integral parameter α</td></tr><tr><td>triplets true</td><td>Calculate singlet-triplet excitations (default: singlet-singlet)</td></tr></tbody></table>
<p>The following example shows how to run such a sTDA calculation using the BHLYP functional if one is interested in all excitations up to 10 eV.</p>
<pre><code>! bhlyp def2-SVP tightscf smallprint printgap nopop %tddft Mode sTDA Ethresh 10.0 end *xyz 0 1 N -1.726176 0.687742 -0.007335 N 1.213763 0.735949 -0.027163 N -1.545188 -2.243058 -0.016803 N 1.395005 -2.195166 -0.036972 C 2.736733 -1.895646 -0.045209 C 3.277248 -0.608637 -0.045175 C 2.575908 0.605756 -0.036945 C 0.977551 2.083559 -0.021690 C -0.288108 2.687287 -0.011220 C -1.529488 2.048274 -0.004419 C -3.067756 0.388045 0.001354 H -0.976948 -0.007843 -0.015911 C -3.608477 -0.899096 0.001258 C -2.907149 -2.113434 -0.007085 C -1.308388 -3.590806 -0.022331 C -0.042695 -4.194596 -0.032673 C 1.198590 -3.555847 -0.039419 H 0.645751 -1.499625 -0.028098 C -3.768181 1.641701 0.010433 C -2.832985 2.651061 0.006924 C 2.228928 2.835679 -0.028158 C 3.228183 1.912006 -0.037679 C 3.437220 -3.149227 -0.053963 C 2.502048 -4.158627 -0.050442 C -3.558669 -3.420017 -0.006390 C -2.559381 -4.343652 -0.015901 H -4.633051 -3.589818 0.000518</code></pre>
<p>(continues on next page)</p>
<pre><code>H -2.644718 -5.427990 -0.018393 H -0.016400 -5.285446 -0.035842 H 2.681678 -5.229875 -0.055110 H 4.519010 -3.247119 -0.061999 H 4.366739 -0.548807 -0.052422 H 2.314239 3.920088 -0.025633 H 4.302487 2.081864 -0.044563 H -0.315062 3.778120 -0.007889 H -3.013895 3.722099 0.011827 H -4.849852 1.740964 0.018679 H -4.697992 -0.958441 0.008649 end</code></pre>
<p>Replacing Mode sTDA by Mode sTDDFT will invoke a sTD-DFT calculation instead. This is shown in the next example in combination with the ω B97X functional and user specified parameters:</p>
<pre><code>! wb97x def2-SVP tightscf smallprint printgap nopop %tddft Mode sTDDFT Ethresh 10.0 axstda 0.56 beta1 8.00 beta2 0.00 alpha1 4.58 alpha2 0.00 end *xyz 0 1 N -1.726176 0.687742 -0.007335 N 1.213763 0.735949 -0.027163 N -1.545188 -2.243058 -0.016803 N 1.395005 -2.195166 -0.036972 C 2.736733 -1.895646 -0.045209 C 3.277248 -0.608637 -0.045175 C 2.575908 0.605756 -0.036945 C 0.977551 2.083559 -0.021690 C -0.288108 2.687287 -0.011220 C -1.529488 2.048274 -0.004419 C -3.067756 0.388045 0.001354 H -0.976948 -0.007843 -0.015911 C -3.608477 -0.899096 0.001258 C -2.907149 -2.113434 -0.007085 C -1.308388 -3.590806 -0.022331 C -0.042695 -4.194596 -0.032673 C 1.198590 -3.555847 -0.039419 H 0.645751 -1.499625 -0.028098 C -3.768181 1.641701 0.010433 C -2.832985 2.651061 0.006924 C 2.228928 2.835679 -0.028158 C 3.228183 1.912006 -0.037679 C 3.437220 -3.149227 -0.053963 C 2.502048 -4.158627 -0.050442 C -3.558669 -3.420017 -0.006390 C -2.559381 -4.343652 -0.015901 H -4.633051 -3.589818 0.000518 H -2.644718 -5.427990 -0.018393 H -0.016400 -5.285446 -0.035842 H 2.681678 -5.229875 -0.055110 H 4.519010 -3.247119 -0.061999 H 4.366739 -0.548807 -0.052422</code></pre>
<p>(continued from previous page)</p>
<p>(continues on next page)</p>
<pre><code>H 2.314239 3.920088 -0.025633 H 4.302487 2.081864 -0.044563 H -0.315062 3.778120 -0.007889 H -3.013895 3.722099 0.011827 H -4.849852 1.740964 0.018679 H -4.697992 -0.958441 0.008649 end</code></pre>
<p>For the range-separated hybrid functionals LC-BLYP, CAM-B3LYP, ω B97, ω B97X, ω B97X-D3and ω B97X-D3BJ, parameters are available and will be used by default if one of these functionals is used. The way of specifying parameters as shown above is useful if there is a range-separated hybrid functional that has not been parametrized for sTDA yet. For very large systems (e.g. &gt; 500 atoms), it may be useful to define an upper boundary PTLimit for the selection of configurations that are beyond EThresh (otherwise the whole configuration space will be scanned). This can be done as shown below:</p>
<pre><code>! cam-b3lyp def2-SVP tightscf smallprint printgap nopop %tddft Mode sTDDFT Ethresh 10.0 PThresh 1e-4 PTLimit 30 end *xyz 0 1 N -1.726176 0.687742 -0.007335 N 1.213763 0.735949 -0.027163 N -1.545188 -2.243058 -0.016803 N 1.395005 -2.195166 -0.036972 C 2.736733 -1.895646 -0.045209 C 3.277248 -0.608637 -0.045175 C 2.575908 0.605756 -0.036945 C 0.977551 2.083559 -0.021690 C -0.288108 2.687287 -0.011220 C -1.529488 2.048274 -0.004419 C -3.067756 0.388045 0.001354 H -0.976948 -0.007843 -0.015911 C -3.608477 -0.899096 0.001258 C -2.907149 -2.113434 -0.007085 C -1.308388 -3.590806 -0.022331 C -0.042695 -4.194596 -0.032673 C 1.198590 -3.555847 -0.039419 H 0.645751 -1.499625 -0.028098 C -3.768181 1.641701 0.010433 C -2.832985 2.651061 0.006924 C 2.228928 2.835679 -0.028158 C 3.228183 1.912006 -0.037679 C 3.437220 -3.149227 -0.053963 C 2.502048 -4.158627 -0.050442 C -3.558669 -3.420017 -0.006390 C -2.559381 -4.343652 -0.015901 H -4.633051 -3.589818 0.000518 H -2.644718 -5.427990 -0.018393 H -0.016400 -5.285446 -0.035842 H 2.681678 -5.229875 -0.055110 H 4.519010 -3.247119 -0.061999 H 4.366739 -0.548807 -0.052422 H 2.314239 3.920088 -0.025633 H 4.302487 2.081864 -0.044563 H -0.315062 3.778120 -0.007889 H -3.013895 3.722099 0.011827</code></pre>
<p>(continued from previous page)</p>
<p>(continues on next page)</p>
<pre><code>H -4.849852 1.740964 0.018679 H -4.697992 -0.958441 0.008649 end</code></pre>
<p>In this case, all excitations up to 10 eV are considered from the very beginning. Configurations between 10 and 30 eV are included if their coupling to the configurations below 10 eV is strong enough (in total larger than PThresh ). All configurations beyond 14 eV are neglected. Note furthermore that for very large systems, using a functional with the correct asymptotic behaviour is very important (due to the fixed amount of GGA exchange, CAM-B3LYP does not provide this property).</p>
<p>The ORCA output will summarize the important properties of your calculation which allows you to check your input:</p>
<pre><code>---------------------------------------------------------------------------------ORCA sTD-DFT CALCULATION please cite in your paper orginal sTDA method: S. Grimme, J. Chem. Phys. 138, 244104 (2013) range-separated sTDA: T. Risthaus, A. Hansen, S. Grimme, Phys. Chem. Chem. Phys. 16, 14408-14419 (2014) sTD-DFT approach: C. Bannwarth, S. Grimme, Comp. Theor. Chem. 1040-1041, 45-53 (2014) ---------------------------------------------------------------------------------spectral range up to (eV) ... 10.000000 occ. MO cut-off (eV) ... -27.751992 virt. MO cut-off (eV) ... 19.711835 perturbation threshold ... 1.000e-04 CSF selection range up to (eV) ... 30.000000 MOs in sTD-DFT ... 150 occ. MOs in sTD-DFT ... 55 virt. in sTD-DFT ... 95 calculate triplets ... no Transforming dipole length integrals ... (read-ok)(trafo-ok) Transforming dipole velocity integrals ... (read-ok)(trafo-ok) Transforming ang. momentum integrals ... (read-ok)(trafo-ok) SCF atom population (using active MOs): 4.196 5.171 5.171 4.196 3.616 3.996 3.991 3.991 3.996 3.616 3.616 0.796 3.996 3.991 3.991 3.996 3.616 0.796 3.893 3.893 4.040 4.040 3.893 3.893 4.040 4.040 0.971 0.971 0.956 0.957 0.957 0.956 0.971 0.971 0.956 0.957 0.957 0.956 Number of electrons in sTDA: 110.000 ax(DF) : 0.3800 s^k : 2.0000 beta (J): 1.8600 alpha (K): 0.9000</code></pre>
<p>The spectroscopic data is also printed out after the calculation has finished:</p>
<p>(continued from previous page)</p>
<p>(continues on next page)</p>
<p>(continued from previous page)</p>
<table><tbody><tr><td>0</td><td>16964.7</td><td>589.5</td><td>0.000083715</td><td>0.00162</td><td>0.02872</td><td>-0.02828</td><td>-0.00022</td></tr><tr><td>1</td><td>19477.4</td><td>513.4</td><td>0.001269789</td><td>0.02146</td><td>-0.09723</td><td>-0.10958</td><td>0.00035</td></tr><tr><td>2</td><td>25753.4</td><td>388.3</td><td>1.245683315</td><td>15.92387</td><td>2.92682</td><td>-2.71234</td><td>-0.02807</td></tr><tr><td>3</td><td>26309.7</td><td>380.1</td><td>1.402883697</td><td>17.55424</td><td>2.84893</td><td>3.07209</td><td>-0.01073</td></tr><tr><td>4</td><td>30311.6</td><td>329.9</td><td>0.000000355</td><td>0.00000</td><td>-0.00146</td><td>-0.00131</td><td>0.00001</td></tr><tr><td>5</td><td>32710.4</td><td>305.7</td><td>0.000000640</td><td>0.00001</td><td>0.00178</td><td>-0.00181</td><td>0.00000</td></tr><tr><td>6</td><td>33285.3</td><td>300.4</td><td>0.349285082</td><td>3.45464</td><td>1.37427</td><td>-1.25134</td><td>-0.01315</td></tr><tr><td>7</td><td>33622.4</td><td>297.4</td><td>0.097718276</td><td>0.95680</td><td>0.64724</td><td>0.73340</td><td>-0.00233</td></tr><tr><td>8</td><td>34974.4</td><td>285.9</td><td>0.000000018</td><td>0.00000</td><td>-0.00024</td><td>0.00024</td><td>0.00024</td></tr><tr><td>9</td><td>34994.6</td><td>285.8</td><td>0.000000073</td><td>0.00000</td><td>-0.00005</td><td>-0.00002</td><td>0.00082</td></tr><tr><td>10</td><td>35723.1</td><td>279.9</td><td>0.000000022</td><td>0.00000</td><td>-0.00021</td><td>-0.00022</td><td>-0.00033</td></tr><tr><td>11</td><td>35826.4</td><td>279.1</td><td>0.008160622</td><td>0.07499</td><td>0.00215</td><td>-0.00104</td><td>0.27383</td></tr><tr><td>12</td><td>36282.4</td><td>275.6</td><td>0.000000000</td><td>0.00000</td><td>-0.00004</td><td>0.00000</td><td>0.00000</td></tr><tr><td>13</td><td>37373.0</td><td>267.6</td><td>0.000000104</td><td>0.00000</td><td>-0.00067</td><td>0.00067</td><td>-0.00012</td></tr><tr><td>14</td><td>37439.7</td><td>267.1</td><td>0.000000030</td><td>0.00000</td><td>0.00036</td><td>0.00037</td><td>0.00000</td></tr><tr><td>15</td><td>38835.7</td><td>257.5</td><td>0.101992631</td><td>0.86460</td><td>0.63387</td><td>0.68029</td><td>-0.00240</td></tr><tr><td>16</td><td>40111.9</td><td>249.3</td><td>0.000001866</td><td>0.00002</td><td>-0.00286</td><td>0.00267</td><td>0.00010</td></tr><tr><td>17</td><td>40376.1</td><td>247.7</td><td>0.119778731</td><td>0.97663</td><td>0.72310</td><td>-0.67358</td><td>-0.00678</td></tr><tr><td>18</td><td>41527.5</td><td>240.8</td><td>0.000000020</td><td>0.00000</td><td>0.00024</td><td>0.00031</td><td>-0.00000</td></tr><tr><td>19</td><td>43202.8</td><td>231.5</td><td>0.000000006</td><td>0.00000</td><td>0.00015</td><td>-0.00014</td><td>-0.00008</td></tr><tr><td>20</td><td>45265.3</td><td>220.9</td><td>0.000000008</td><td>0.00000</td><td>0.00013</td><td>-0.00014</td><td>0.00014</td></tr><tr><td>21</td><td>46775.7</td><td>213.8</td><td>0.000000000</td><td>0.00000</td><td>0.00002</td><td>0.00003</td><td>0.00001</td></tr><tr><td>22</td><td>49449.3</td><td>202.2</td><td>0.151078886</td><td>1.00582</td><td>0.73590</td><td>-0.68133</td><td>-0.00709</td></tr><tr><td>23</td><td>51144.8</td><td>195.5</td><td>0.000000001</td><td>0.00000</td><td>0.00005</td><td>-0.00007</td><td>0.00003</td></tr><tr><td>24</td><td>51371.9</td><td>194.7</td><td>0.000000069</td><td>0.00000</td><td>-0.00047</td><td>-0.00047</td><td>-0.00000</td></tr><tr><td>25</td><td>53195.6</td><td>188.0</td><td>0.002581321</td><td>0.01598</td><td>0.00537</td><td>-0.00532</td><td>-0.12617</td></tr><tr><td>26</td><td>53198.4</td><td>188.0</td><td>0.000000045</td><td>0.00000</td><td>-0.00031</td><td>-0.00038</td><td>-0.00020</td></tr><tr><td>27</td><td>53341.2</td><td>187.5</td><td>0.065343188</td><td>0.40329</td><td>0.46944</td><td>-0.42767</td><td>-0.00298</td></tr><tr><td>28</td><td>54136.6</td><td>184.7</td><td>0.006562015</td><td>0.03990</td><td>0.13280</td><td>0.14923</td><td>-0.00049</td></tr><tr><td>29</td><td>54279.9</td><td>184.2</td><td>0.086565034</td><td>0.52502</td><td>0.49226</td><td>0.53170</td><td>-0.00183</td></tr><tr><td>30</td><td>54285.4</td><td>184.2</td><td>0.078803195</td><td>0.47790</td><td>-0.46967</td><td>-0.50725</td><td>0.00179</td></tr><tr><td>31</td><td>54351.4</td><td>184.0</td><td>0.000000001</td><td>0.00000</td><td>0.00005</td><td>0.00004</td><td>-0.00006</td></tr><tr><td>32</td><td>54428.8</td><td>183.7</td><td>0.000000565</td><td>0.00000</td><td>0.00124</td><td>0.00137</td><td>-0.00011</td></tr><tr><td>33</td><td>55214.4</td><td>181.1</td><td>0.130630885</td><td>0.77888</td><td>0.64617</td><td>-0.60109</td><td>-0.00629</td></tr><tr><td>34</td><td>55671.1</td><td>179.6</td><td>0.000000219</td><td>0.00000</td><td>0.00083</td><td>-0.00077</td><td>0.00011</td></tr><tr><td>35</td><td>56264.4</td><td>177.7</td><td>0.000000097</td><td>0.00000</td><td>0.00051</td><td>0.00055</td><td>-0.00000</td></tr><tr><td>36</td><td>56499.9</td><td>177.0</td><td>0.013901825</td><td>0.08100</td><td>-0.19211</td><td>-0.20999</td><td>0.00072</td></tr><tr><td>37</td><td>56694.8</td><td>176.4</td><td>0.000000005</td><td>0.00000</td><td>-0.00012</td><td>-0.00011</td><td>0.00000</td></tr><tr><td>38</td><td>56885.1</td><td>175.8</td><td>0.000000018</td><td>0.00000</td><td>-0.00022</td><td>-0.00024</td><td>-0.00001</td></tr><tr><td></td><td>57366.4</td><td>174.3</td><td>0.000144667</td><td></td><td></td><td>0.02497</td><td></td></tr><tr><td>39</td><td></td><td></td><td></td><td>0.00083</td><td>0.01438</td><td></td><td>-0.00003</td></tr></tbody></table>
<h2>5.6.9 Double-hybrid functionals and Doubles Correction</h2>
<p>The program can compute a doubles correction to the CIS excitation energies. The theory is due to Head-Gordon and co-workers.[636] The basic idea is to compute a perturbative estimate (inspired by EOM-CCSD theory) to the CIS excited states that is compatible with the MP2 ground state energy. In many cases this is a significant improvement over CIS itself and comes at a reasonable cost since the correction is computed a posteriori . Of course, if the CIS prediction of the excited state is poor, the (D) correction - being perturbative in nature - cannot compensate for qualitatively wrong excited state wavefunctions.</p>
<p>In addition - and perhaps more importantly - the (D) correction is compatible with the philosophy of the doublehybrid functionals and should be used if excited states are to be computed with these functionals. The results are usually much better than those from TD-DFT since due to the large fraction HF exchange, the self-interaction error is much smaller than for other functionals and after the (D) correction the results do not suffer from the overestimation of transition energies that usually comes with increased amounts of HF exchange in TD-DFT calculations.</p>
<p>Since the calculations would require a fairly substantial integral transformation that would limit it to fairly small</p>
<p>molecules if no approximation are introduced we have decided to only implement a RI version of it. With this approximation systems with more than 1000 basis functions are readily within the reach of the implementation.</p>
<p>Since one always has a triad of computational steps: MP2-CIS solution-(D) correction, we have implemented several algorithms that may each become the method of choice under certain circumstances. The choice depends on the size of the system, the number of roots, the available main memory and the available disk space together with the I/O rate of the system. The formal cost of the (D) correction is O ( N 5 ) and its prefactor is higher than that of RI-MP2. In the best case scenario, the rate limiting step would be the calculation of the pair-contribution in the 'U-term' which requires (for a closed-shell system) twice the effort of a RI-MP2 calculation per state .</p>
<h2>The use of the (D)-correction is simple. Simply write:</h2>
<pre><code>! HF DEF2-SVP DEF2-SVP/C TightSCF %cis dcorr n # n=1-4. The meaning of the four algorithms is # explained below. # algorithm 1 Is perhaps the best for small systems. May use a # lot of disk space # algorithm 2 Stores less integrals # algorithm 3 Is good if the system is large and only a few # states are calculated. Saves disk and main # memory. # algorithm 4 Uses only transformed RI integrals. May be the # fastest for large systems and a larger number # of states end</code></pre>
<p>Table 5.7: Integral handling in various implementations of the (D) correction (i,j=occupied MOs, a,b=virtual MOs, Q=aux function; NumInt=numerical integration).</p>
<table><tbody><tr><th>DCORR =</th><th>1</th><th>2</th><th>3</th><th>4</th></tr><tr><td>(ia|jb) integrals (ij|ab) integrals (ab|Q) integrals (ij|Q) integrals (ia|Q) integrals Coulomb CIS Exchange CIS XC-CIS V-term in (D) U-term in (D)</td><td>Stored Stored Stored Stored Stored From (ia|jb) From (ij|ab) Num. Int. From (ia|jb) From (ab|Q)</td><td>Stored Not made Not made Stored Stored From (ia|jb) RI-AO-direct Num. Int. From (ia|jb) RI-AO-direct</td><td>Not stored Not made Not made Stored Stored From (ia|Q) RI-AO-direct Num. Int. From (ia|Q) RI-AO-direct</td><td>Not stored Not made Stored Stored Stored From (ia|Q) From (ab|Q) Num. Int. From (ia|Q) From (ab|Q)</td></tr></tbody></table>
<p>Spin-component scaling versions of CIS(D) can be evoked in the %cis block by setting DOSCS TRUE and the four scaling parameters, as defined by Head-Gordon and co-workers [637], in the following order: same-spin indirect term (CTss), opposite-spin indirect term(CTos), same-spin direct term(CUss), and opposite-spin direct term(CUos). Note that this implementation only works for the version with the parameter λ = 1 as defined in Ref. [637]. The example below shows how to apply the SCS-CIS(D) version with λ = 1 whose usage has been advocated in Ref. [638]. The user is able to specify other scaling parameters.</p>
<pre><code>%cis dcorr # n=1,2,3,4 doscs true # set SCS-CIS(D) to true (default: false) scspar 0.333, 1.2, 0.43, 1.24 #SCS-CIS(D) scaling parameters in this order CTss, CTos, CUss, CUos end</code></pre>
<p>Note the use of commas to separate the parameters. These parameters do not communicate with the SCS/SOS parameters set for ground-state SCS/SOS-MP2 in the %mp2 block.</p>
<h2>® Note</h2>
<ul>
<li style="list-style-type: '· ';">CIS(D) is often a quite big improvement over CIS.</li>
<li style="list-style-type: '· ';">In all three involved code sections (MP2, CIS, (D)) the storage format FLOAT is respected. It cuts down use of disk and main memory by a factor of two compared the default double precision version. The loss of accuracy should be negligible; however it is - as always in science - better to double check.</li>
<li style="list-style-type: '· ';">The (ab|Q) list of integrals may be the largest for many systems and easily occupies several GB of disk space (hence algorithms 2 and 3). However, that disk-space is often well invested unless you run into I/O bottlenecks.</li>
<li style="list-style-type: '· ';">The (ia|jb) and (ij|ab) lists of integrals is also quite large but is relatively efficiently handled. Nevertheless, I/O may be a problem.</li>
<li style="list-style-type: '· ';">The cost of the (D) correction is O(N 5 ) and therefore comparable to RI-MP2. Since there are quite a few things more to be done for (D) compared to RI-MP2, expect the calculations to take longer. In the most elementary implementation the cost is about two times the time for RI-MP2 for each root.</li>
<li style="list-style-type: '· ';">The (D) correction is compatible with the philosophy of the double-hybrid density functionals and should be used if these functionals are combined with TD-DFT. The program takes this as the default but will not enforce it. The (D) correction can be used both in a TD-DFT and TDA-DFT context.</li>
<li style="list-style-type: '· ';">In our implementation it is only implemented together with the RI approximation and therefore you need to supply an appropriate ('/C') fitting basis.</li>
<li style="list-style-type: '· ';">The program will automatically put the RI-MP2 module into operation together with the (D) correction. This will result in the necessary integrals becoming available to the CIS module.</li>
<li style="list-style-type: '· ';">Making the exchange contribution to the CIS residual vector in an RI-AO direct fashion becomes quite expensive for a larger number of states. It may be a good choice if only one or two excited states are to be calculated for a larger system.</li>
<li style="list-style-type: '· ';">Singlet-triplet excitations can be calculated by setting TRIPLETS TRUE in the %cis or %tddft blocks, respectively. The implementation has been tested for double hybrids in Ref. [639].</li>
<li style="list-style-type: '· ';">For spin-adapted triplets (TRIPLETS TRUE), the only option available currently is DCORR 1.</li>
<li style="list-style-type: '· ';">Spin-component and spin-opposite scaling techniques for double-hybrids within the TD- and TDA-DFT frameworks, as defined by Schwabe and Goerigk [640], can be evoked in the same way in the %tddft block as described for SCS-CIS(D) above. While user-defined parameters can be entered in such a way, a series of new functionals are available through normal keywords, which use the herein presented SCS/SOS-CIS(D) implementation. [266] See Sec. Basic Usage for a list of those functionals.</li>
<li style="list-style-type: '· ';">Usage of time-dependent double-hybrids should be cited as follows: For TD or TDA with any double hybrid,[641] TD-B2GPLYP,[642] TDA-PBE0-DH or TDA-PBE0-2,[643] TD-PBE0-DH, TD-PBE02, or TDA-B2GP-PLYP [640], TDω B2PLYP or TDω B2GPPLYP [270], TDAω B2PLYP or TDAω B2GPPLYP [639], TD(A)-RSX-QIDH or TD(A)-RSX-0DH [639], TDA-PBE-QIDH [268], TD-PBEQIDH [644], TD(A)-DSD-BLYP or TD(A)-DSD-PBEP86 or many other spin-component-scaled doublehybrid functionals with TD(A)-DFT from 2017 [640], TD(A) ω B88PP86 or TD(A) ω PBEPP86 or many other spin-component and opposite scaled double hybrids with TD(A)-DFT from 2021 [266].</li>
<li style="list-style-type: '· ';">Note that SCS/SOS-CIS(D) is only automatically used when a TD(A)-DFT calculation is requested for the functionals from 2021 by Casanova-Páez and Goerigk. [266] In those instances, 'doscs' has not to be set. SCS/SOS-CIS(D) is not automatically used for PWPB95, ω wB97X-2, or the DSD functionals.</li>
</ul>
<h2>5.6.10 Spin-orbit coupling</h2>
<p>It also possible to include spin-orbit coupling between singlets and triplets calculated from TD-DFT by using quasidegenerate perturbation theory (please refer to the relevant publication [601]), similarly to what is done in ROCIS. In order to do that, the flag DOSOC must be set to TRUE. The reduced matrix elements are printed and the new transition dipoles between all SOC coupled states are also printed after the regular ones. This option is currently still not compatible with double hybrids, but works for all other cases including CPCM. All the options regarding the SOC integrals can be altered in the %rel block, as usual.</p>
<pre><code>%CIS DOSOC TRUE END</code></pre>
<p>Please have in mind that, as it is, you can only calculate the SOC between excited singlets and the spin-adapted triplets. There is no SOC starting from a UHF/UKS wavefunction. If you want more information printed such as the full SOC matrix or triplet-triplet couplings, please set a higher PRINTLEVEL.</p>
<h2>SOC and ECPs</h2>
<p>ORCA currently does not have SOC integrals for ECPs, and these are by default ignored in the SOC module. If you try to use ORCA together with ECPs, an abort message will be printed. If you absolutely need to use ECPs, for instance for embedded potentials, please use:</p>
<pre><code>%TDDFT FORCEECP TRUE END</code></pre>
<p>OBS.: Do not use ECPs in atoms where SOC might be important. In that case, always use all-electron basis functions or the results will not make sense.</p>
<h2>5.6.11 Natural Transition Orbitals</h2>
<p>Results of TD-DFT or CIS calculations can be tedious to interprete as many individual MO pairs may contribute to a given excited state. In order to facilitate the analysis while keeping the familiar picture of an excited state originating from essentially an electron being promoted from a donor orbital to an acceptor orbital, the concept of 'natural transition orbitals' can be used.</p>
<p>The procedure is quite straightforward. For example, consider the following job on the pyridine molecule:</p>
<pre><code>! PBE def2-SVP tightscf %tddft nroots 5 DoNTO true # flag to turn on generation of natural transition orbitals NTOStates 1,2,3 # States to consider for NTO analysis; # if empty all will be done NTOThresh 1e-4 # threshold for printing occupation numbers end * xyz 0 1 N 0.000000 0.000000 1.401146 C 0.000000 1.146916 0.702130 C 0.000000 -1.146916 0.702130 C -0.000000 1.205574 -0.702848 C -0.000000 -1.205574 -0.702848 C 0.000000 -0.000000 -1.421344 H -0.000000 2.079900 1.297897 H -0.000000 -2.079900 1.297897 H -0.000000 2.179600 -1.219940 H -0.000000 -2.179600 -1.219940 H 0.000000 0.000000 -2.525017 *</code></pre>
<p>which results in:</p>
<pre><code>------------------------------------------NATURAL TRANSITION ORBITALS FOR STATE 1 ------------------------------------------Making the (pseudo)densities ... done Solving eigenvalue problem for the occupied space ... done Solving eigenvalue problem for the virtual space ... done Natural Transition Orbitals were saved in example10.s1.nto Threshold for printing occupation numbers 0.000100 E= 0.157831 au 4.295 eV 34639.9 cm**-1 20a -> 21a : n= 0.99945993 19a -> 22a : n= 0.00018772 18a -> 23a : n= 0.00018562 ------------------------------------------NATURAL TRANSITION ORBITALS FOR STATE 2 ------------------------------------------Making the (pseudo)densities ... done Solving eigenvalue problem for the occupied space ... done Solving eigenvalue problem for the virtual space ... done Natural Transition Orbitals were saved in example10.s2.nto Threshold for printing occupation numbers 0.000100 E= 0.158973 au 4.326 eV 34890.5 cm**-1 20a -> 21a : n= 0.99857289 19a -> 22a : n= 0.00054014 18a -> 23a : n= 0.00039643 17a -> 24a : n= 0.00029339 ------------------------------------------NATURAL TRANSITION ORBITALS FOR STATE 3 ------------------------------------------Making the (pseudo)densities ... done Solving eigenvalue problem for the occupied space ... done Solving eigenvalue problem for the virtual space ... done Natural Transition Orbitals were saved in example10.s3.nto Threshold for printing occupation numbers 0.000100 E= 0.200016 au 5.443 eV 43898.4 cm**-1 20a -> 21a : n= 0.63243468 19a -> 22a : n= 0.36314467 18a -> 23a : n= 0.00120185 17a -> 24a : n= 0.00103035 16a -> 25a : n= 0.00063379 15a -> 26a : n= 0.00051555 14a -> 27a : n= 0.00040257 13a -> 28a : n= 0.00020605 12a -> 29a : n= 0.00013070 11a -> 30a : n= 0.00010297 -----------------------------TD-DFT/TDA-EXCITATION SPECTRA -----------------------------Center of mass = ( 0.0000, 0.0000, 0.0036) Generating CIS transition densities ... done</code></pre>
<p>(continues on next page)</p>
<p>(continued from previous page)</p>
<table><tbody><tr><th colspan="3">----------------------------------------------------------------------------------- ↪ → -----------------</th><th>ABSORPTION SPECTRUM</th><th>VIA</th><th>TRANSITION</th><th>ELECTRIC DIPOLE -----------------------------------------------------------------------------------</th><th>MOMENTS</th><td></td></tr><tr><th colspan="3">↪ → -----------------</th><th>Energy</th><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><th colspan="2">Transition</th><th>Energy</th><th>Wavelength</th><th>fosc(D2)</th><th>D2</th><th>DX</th><th>␣</th></tr><tr><th>↪ → DY</th><td></td><th>DZ</th><th>(eV)</th><th>(nm)</th><td></td><th>(au**2)</th><th>(au)</th><th>␣</th></tr><tr><th>↪</th><th>(au)</th><td></td><th>(cm-1)</th><td></td><td></td><td></td><td></td><td></td></tr><tr><th>→ -----------------------------------------------------------------------------------</th><th>(au)</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>↪ → 0-1A -&gt; ↪ → 0.00000</td><td>----------------- 1-1A -0.00000</td><td>4.294795</td><td>34639.9</td><td>288.7</td><td>0.000000000</td><td>0.00000</td><td>0.00000</td><td>-</td></tr><tr><td>0-1A -&gt; ↪ → 0.00000</td><td>2-1A 0.00000</td><td>4.325874</td><td>34890.5</td><td>286.6</td><td>0.003830922</td><td>0.03615</td><td>0.19012</td><td>␣</td></tr><tr><td>0-1A -&gt; ↪ → 0.37861</td><td>3-1A 0.00000</td><td>5.442702</td><td>43898.4</td><td>227.8</td><td>0.019114326</td><td>0.14335</td><td>0.00000</td><td>-</td></tr><tr><td>0-1A -&gt; ↪ → 0.00000</td><td>4-1A 0.33078</td><td>6.579556</td><td>53067.7</td><td>188.4</td><td>0.017637721</td><td>0.10942</td><td>0.00000</td><td>␣</td></tr><tr><td>0-1A -&gt;</td><td>5-1A</td><td>6.739163</td><td>54355.0</td><td>184.0</td><td>0.007560799</td><td>0.04579</td><td>-0.00000</td><td>-</td></tr><tr><td>↪ → 0.00000</td><td>0.21399</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table>
<p>We see that there is a weakly allowed transition (STATE 2) that is essentially totally composed of a single NTO pair (20a → 21a : n= 0.99857289), while the third excited state (S3) is strongly allowed and requires two NTO pairs for its description (20a → 21a : n= 0.63243468 and 19a → 22a : n= 0.36314467).</p>
<p>These orbitals are shown below. It is evident that the state 2 donor orbital (NTO20) is a nitrogen lone pair and the acceptor orbital is a π ∗ orbital of the ring. For the state 3 the two NTO donor orbitals are comprised of a nearly degenerate set of π orbitals (they would be degenerate in the parent benzene) and the acceptor orbitals are a pair of nearly degenerate π ∗ orbitals. It is evident from this example that by looking at the NTOs one can obtain a nicely pictorial view of the transition process, even if many orbital pairs contribute to a given excited state in the canonical basis.</p>
<figure><figcaption><div class="caption">Fig. 5.22: Natural transition orbitals for the pyridine molecule in state 2 and state 3.</div></figcaption></figure>
<p>Similar analysis can be performed in the case of ROCIS and DFT/ROCIS calculations as it will be described in section Natural Transition Orbitals/ Natural Difference Orbitals .</p>
<h2>5.6.12 Computational Aspects</h2>
<h2>RI Approximation (AO-Basis)</h2>
<p>If the SCF calculation used the RI approximation it will also be used in the TD-DFT calculation. The RI approximation saves a large amount of time while giving close to identical results (the errors will usually be &lt; 0.1 eV) and is generally recommended. If the functional is a hybrid functional the RI-approximation will only be applied to the Coulomb term while the exchange will be treated as before. In the SCF you can use this feature with the keyword ( ! RIJONX ). It will then also be used in the TD-DFT calculation. Again, the RIJCOSX approximation can be used in TD-DFT and CIS calculations and leads to very large speedups at virtually no loss in accuracy.</p>
<h2>Integral Handling</h2>
<p>If the SCF calculation is carried out in an integral direct fashion this will also be done in the CIS/TD-DFT calculation. Thus, no bottlenecks arising from large integral transformations or large disk space requirement arise in the calculations. An exception is the MO based RI approximations described in the previous section.</p>
<h2>Valence versus Rydberg States</h2>
<p>For valence excited states the usual orbital basis sets are reasonable. Thus, with polarized double-zeta basis sets sensible results are obtained. Especially DFT calculations have the nice feature of not being overly basis set dependent.</p>
<p>If Rydberg states are desired, you should make sure that diffuse functions are present in your basis set. You could always use the augmented-specific basis, e.g. DEF2-TZVPD, ma-DEF2-TZVP, or aug-cc-pVTZ, or add some extra diffuse basis to your regular basis. These can be added to any 'normal' basis set. For example, the following example provides a rather high quality basis for excited state calculations that is based on the Ahlrichs basis set:</p>
<pre><code>%basis # augment the carbon basis set by diffuse functions addgto 6 s 1 1 0.01 1.0 p 1 1 0.01 1.0 d 1 1 0.07 1.0 end end</code></pre>
<p>b</p>
<h2>Tip</h2>
<p>If you want to augment a given basis set it is sensible to run a preliminary SCF calculation and use %output print[p_basis] 2 end . This will provide you with a detailed listing of basis functions and their exponents. You can then add additional s, p and perhaps d-functions with the AddGTO command as in the example above. It is sensible to decrease the exponent of the diffuse functions by roughly a factor of 3 from the smallest exponent in the original basis.</p>
<h2>Restrictions for Range-Separated Density Functionals</h2>
<p>Several restrictions apply for range-separated (hybrid as well as double-hybrid) density functionals. They are currently only implemented to work with the AO-based algorithm within the RIJONX, RIJCOSX, and NORI integral schemes. Additionally, the asymptotic correction has been disabled. However, the nuclear gradient for the excited states is now available, including for the triplets. Please no that the IROOTMULT flag must be set to TRIPLET under %CIS or %TDDFT in order to obtain that.</p>
<h2>Printing Extra Gradients Sequentially</h2>
<p>If you want to print extra gradients for external applications or any other reason, you can use the keywords SGRADLIST and TGRADLIST, for singlets and triplets. This will print the gradients sequentially after the CIS/TDDFT run. If you put 0 on the singlet list, the ground state gradient will also be added, always at the end.</p>
<pre><code>%TDDFT SGRADLIST 0, 1, 2 TGRADLIST 2, 3 END</code></pre>
<p>In order to save this gradients in a text file, please use:</p>
<pre><code>%METHOD STORECISGRAD TRUE END</code></pre>
<h2>5.6.13 Restarting TD-DFT Calculations</h2>
<p>TD-DFTamplitudes are stored by default in the GBW file. This also means that TD-DFT calculations can be restarted, if a suitable GBW file is provided. The restart is relatively flexible. It allows for the geometry, basis set or density functional to change between the source and target calculation. However, the source calculation must at least have the same number of roots than the target calculation or more, fewer roots in the source is not allowed. Here is a simple example:</p>
<pre><code>* gzmt 0 1 O H 1 1.0 H 1 1.0 2 104.0 * %compound New_Step ! B3LYP def2-SVP def2/J VeryTightSCF PModel %Base "FirstJob" %cis nroots 10 triplets true tda true end Step_end New_Step ! B3LYP def2-SVP def2/J VeryTightSCF %Base "SecondJob" %cis nroots 10 triplets true tda true Restart "FirstJob.gbw" end Step_end endrun;</code></pre>
<h2>® Note</h2>
<ul>
<li style="list-style-type: '· ';">This is supposed to work for all combinations of TDA or RPA, singlets and triplets and also for spin-flip TD-DFT calculations.</li>
<li style="list-style-type: '· ';">We make several consistency checks but it will certainly be possible to create nonsensical inputs that will fail - please proceed with caution.</li>
</ul>
<h2>5.6.14 Use of TD-DFT for the Calculation of X-ray Absorption Spectra</h2>
<p>In principle X-ray absorption spectra are 'normal' absorption spectra that are just taken in a special high-energy wavelength range. Due to the high energy of the radiation employed (several thousand eV), core-electrons rather than valence electrons are excited. This has two consequences: a) the method becomes element specific because the core-level energies divide rather cleanly into regions that are specific for a given element. b) the wavelength of the radiation is so short that higher-order terms in the expansion of the light-matter interaction become important. Most noticeably, quadrupole intensity becomes important.</p>
<p>X-ray absorption spectra can be generally divided into three regions: a) the pre-edge that corresponds to transitions of core electrons into low lying virtual orbitals that lead to bound states. b) the rising edge that corresponds to excitations to high-lying states that are barely bound, and c) the extended X-ray absorption fine structure region (EXAFS) that corresponds to electrons being ejected from the absorber atom and scattered at neighbouring atoms.</p>
<p>With the simple TD-DFT calculations described here, one focuses the attention on the pre-edge region. Neither the rising edge nor the EXAFS region are reasonably described with standard electronic structure methods and no comparison should be attempted. In addition, these calculations are restricted to K-edges as the calculation of L-edges is much more laborious and requires a detailed treatment of the core hole spin orbit coupling.</p>
<p>It is clearly hopeless to try to calculate enough states to cover all transitions from the valence to the pre-edge region. Hence, instead one hand-selects the appropriate donor core orbitals and only allows excitations out of these orbitals into the entire virtual space. This approximation has been shown to be justified.[645] One should distinguish two situations: First, the core orbital in question may be well isolated and unambiguously defined. This is usually the case for metal 1s orbitals if there is only one metal of the given type in the molecule. Secondly, there may be several atoms of the same kind in the molecule and their core orbitals form the appropriate symmetry adapted linear combinations dictated by group theory. In this latter case special treatment is necessary: The sudden approximation dictates that the excitations occurs from a local core orbital. In previous versions of the program you had to manually localize the core holes. In the present version there is an automatic procedure that is described below.</p>
<p>A typical example is TiCl 4 . If we want to calculate the titanium K-edge, the following input is appropriate:</p>
<pre><code>! BP86 x2c x2c-SVPall x2c/J TightSCF %tddft OrbWin[0] = 0,0,-1,-1 NRoots 25 DecomposeFosc true DoFullSemiclassical true end * int 0 1 Ti 0 0 0 0 0 0 Cl 1 2 3 2.15 0 0 Cl 1 2 3 2.15 109.4712 0 Cl 1 2 3 2.15 109.4712 120 Cl 1 2 3 2.15 109.4712 240 *</code></pre>
<ul>
<li style="list-style-type: '· ';">The absolute transition energies from such calculations are off by a few hundred electron volts due to the shortcomings of DFT. The shift is constant and very systematic for a given element. Hence, calibration is possible and has been done for a number of edges already. Calibration depends on the basis set!</li>
<li style="list-style-type: '· ';">Electric quadrupole contributions and magnetic dipole contributions have been invoked with DecomposeFosc true (check section One Photon Spectroscopy for more information), which is essential for metal edges. For ligand edges, the contributions are much smaller.</li>
<li style="list-style-type: '· ';">OrbWin is used to select the single donor orbital (in this case the metal 1s). The LUMO (45) and last orbital in the set (174) are selected automatically if '-1' is given. This is different from previous program versions where the numbers had to be given manually.</li>
</ul>
<p>The output contains standard TD-DFT output:</p>
<table><tbody><tr><th colspan="3">----------------------------------------------------------------------------------- ↪ → -----------------</th><th>ABSORPTION</th><th>SPECTRUM</th><th>VIA TRANSITION</th><th>ELECTRIC -----------------------------------------------------------------------------------</th><th>DIPOLE</th><th>MOMENTS</th><td></td></tr><tr><th>→</th><th colspan="2">----------------- Transition</th><th>Energy</th><th>Energy</th><th>Wavelength</th><th>fosc(D2)</th><td>D2</td><th>DX</th><th>␣</th></tr><tr><th>↪ → DY</th><td></td><td></td><th>(eV)</th><th>(cm-1)</th><th>(nm)</th><td></td><th>(au**2)</th><th>(au)</th><th>␣</th></tr><tr><th>↪ → (au)</th><td></td><th>(au)</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><th>-----------------------------------------------------------------------------------</th><td></td><td></td><td></td></tr><tr><th>↪ →</th><td></td><th>-----------------</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt;</td><td>1-1A 0.00000</td><td>4864.738909 0.00000</td><td>39236769.5</td><td>0.3</td><td>0.000000000</td><td>0.00000</td><td>-0.</td><td></td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt;</td><td>2-1A 0.00000</td><td>4864.738936 -0.00000</td><td>39236769.7</td><td>0.3</td><td>0.000000000</td><td>0.00000</td><td>0.</td><td></td></tr><tr><td>0-1A 00041</td><td>-&gt;</td><td>3-1A 0.00173</td><td>4865.587026 0.00000</td><td>39243610.0</td><td>0.3</td><td>0.000378325</td><td>0.00000</td><td>-0.</td><td></td></tr><tr><td>↪ → 0-1A ↪ 00000</td><td>-&gt;</td><td>4-1A -0.00000</td><td>4865.587084 0.00178</td><td>39243610.5</td><td>0.3</td><td>0.000378325</td><td>0.00000</td><td>-0.</td><td></td></tr><tr><td>→ 0-1A ↪ 00173</td><td>-&gt;</td><td>5-1A 0.00041</td><td>4865.587090 0.00000</td><td>39243610.6</td><td>0.3</td><td>0.000378325</td><td>0.00000</td><td>0.</td><td></td></tr><tr><td>→ 0-1A ↪ → 00000</td><td>-&gt;</td><td>6-1A 0.00000</td><td>4868.943422 0.00000</td><td>39270681.2</td><td>0.3</td><td>0.000000000</td><td>0.00000</td><td>0.</td><td></td></tr><tr><td>0-1A ↪ 00000</td><td>-&gt;</td><td>7-1A -0.00000</td><td>4872.449970 -0.00262</td><td>39298963.4</td><td>0.3</td><td>0.000822318</td><td>0.00001</td><td>0.</td><td></td></tr><tr><td>→ 0-1A 00168</td><td>-&gt;</td><td>8-1A</td><td>4872.450113</td><td>39298964.6</td><td>0.3</td><td>0.000822428</td><td>0.00001</td><td>0.</td><td></td></tr><tr><td>↪ → 0-1A ↪ → 00202</td><td>-&gt; 9-1A</td><td>-0.00202 0.00168</td><td>0.00000 4872.450248 -0.00000</td><td>39298965.7</td><td>0.3</td><td>0.000822896</td><td>0.00001</td><td>0.</td><td></td></tr><tr><td>0-1A 00000</td><td>-&gt; 10-1A</td><td>0.00000</td><td>4873.185027</td><td>39304892.1</td><td>0.3</td><td>0.000000000</td><td>0.00000</td><td>0.</td><td></td></tr><tr><td>↪ → 0-1A ↪ 00035</td><td>-&gt; 11-1A</td><td>-0.00000</td><td>4873.752986</td><td>39309473.0</td><td>0.3</td><td>0.001152303</td><td>0.00001</td><td>0.</td><td></td></tr><tr><td>→ 0-1A ↪ → 00001</td><td>-0.00309 -&gt; 12-1A 0.00000</td><td>0.00000 0.00311</td><td>4873.753219</td><td>39309474.8</td><td>0.3</td><td>0.001152646</td><td>0.00001</td><td>-0.</td><td></td></tr><tr><td>0-1A ↪ 00309</td><td>-&gt; 13-1A -0.00035</td><td>4873.753350 -0.00001</td><td></td><td>39309475.9</td><td>0.3</td><td>0.001152359</td><td>0.00001</td><td>-0.</td><td></td></tr><tr><td>→ 0-1A</td><td>-&gt; 14-1A</td><td></td><td>4873.877226</td><td>39310475.0</td><td>0.3</td><td>0.000000003</td><td>0.00000</td><td>-0.</td><td></td></tr><tr><td>↪ → 00000 0-1A ↪ 00000</td><td>0.00000 -&gt; 15-1A 0.00000</td><td>0.00000 0.00000</td><td>4873.877345</td><td>39310476.0</td><td>0.3</td><td>0.000000000</td><td>0.00000</td><td>0.</td><td></td></tr><tr><td>→ 0-1A ↪ 00000</td><td>-&gt; 16-1A -0.00000</td><td>4881.110098 -0.00000</td><td></td><td>39368812.1</td><td>0.3</td><td>0.000000000</td><td>0.00000</td><td>-0.</td><td></td></tr><tr><td>→ 0-1A ↪ 00000</td><td>-&gt; 17-1A -0.00000</td><td>0.00000</td><td>4881.110123</td><td>39368812.3</td><td>0.3</td><td>0.000000000</td><td>0.00000</td><td>-0.</td><td></td></tr><tr><td>→ 0-1A ↪ → 00021</td><td>-&gt; 18-1A -0.00029</td><td>4883.621665 -0.00000</td><td></td><td>39389069.2</td><td>0.3</td><td>0.000014919</td><td>0.00000</td><td>0.</td><td></td></tr></tbody></table>
<p>(continues on next page)</p>
<p>(continued from previous page)</p>
<table><tbody><tr><td>0-1A ↪ → 00000</td><td>-&gt; 19-1A 0.00000</td><td>4883.621737 -0.00035</td><td>39389069.8</td><td>0.3</td><td>0.000014917</td><td>0.00000</td><td>-0.</td></tr><tr><td>0-1A ↪ → 00029</td><td>-&gt; 20-1A 0.00021</td><td>4883.621842 -0.00000</td><td>39389070.7</td><td>0.3</td><td>0.000014922</td><td>0.00000</td><td>0.</td></tr><tr><td>0-1A ↪ → 00069</td><td>-&gt; 21-1A 0.00092</td><td>4884.177852 0.00000</td><td>39393555.2</td><td>0.3</td><td>0.000158653</td><td>0.00000</td><td>-0.</td></tr><tr><td>0-1A ↪ → 00092</td><td>-&gt; 22-1A -0.00069</td><td>4884.178076 0.00001</td><td>39393557.0</td><td>0.3</td><td>0.000158639</td><td>0.00000</td><td>-0.</td></tr><tr><td>0-1A ↪ → 00001</td><td>-&gt; 23-1A -0.00001</td><td>4884.178104 -0.00115</td><td>39393557.2</td><td>0.3</td><td>0.000158643</td><td>0.00000</td><td>-0.</td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 24-1A 0.00000</td><td>4885.935396 0.00000</td><td>39407730.7</td><td>0.3</td><td>0.000000000</td><td>0.00000</td><td>0.</td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 25-1A -0.00000</td><td>4885.941881 0.00000</td><td>39407783.0</td><td>0.3</td><td>0.000000000</td><td>0.00000</td><td>-0.</td></tr></tbody></table>
<p>One may obtain origin independent transition moments formulations which can be combined with the multipole moments up to 2nd order to regenerate the electric dipole, electric quadrupole and magnetic dipole contributions in either length or the velocity representations. This requires in addition to the electric dipole (D), electric quadrupole (Q) and magnetic dipole (m) intensities the corresponding electric dipole - magnetic quadrupole (DM) and the electric dipole - electric octupole (DO) intensities.[646][647]. See also section Excited States with Restricted Open-shell CIS ROCIS .</p>
<p>These spectra are requested by:</p>
<table><tbody><tr><td>DecomposeFosc</td><td>true</td></tr></tbody></table>
<p>Check section One Photon Spectroscopy for more information.</p>
<p>Resulting in:</p>
<table><tbody><tr><td colspan="9">----------------------------------------------------------------------------------- ↪ → --------------------------------------------- ABSORPTION SPECTRUM COMBINED ELECTRIC DIPOLE + MAGNETIC␣</td></tr><tr><th>↪ → Transition ↪ → fosc(D2+M2+Q2+DM+DO)</th><th>Energy D2/TOT (eV)</th><th>---------------------------------------------</th><th>Energy M2/TOT (cm-1)</th><th>Wavelength Q2/TOT (nm)</th><th>fosc(D2) (au) -----------------------------------------------------------------------------------</th><th>fosc(M2) (au*1e6)</th><th colspan="2">fosc(Q2)␣ (au*1e6)</th></tr><tr><td>↪ → 0-1A -&gt; ↪ →</td><td>1-1A 0.00000357413611</td><td>--------------------------------------------- 4864.738909 0.00000</td><td>39236769.5 0.00000</td><td>0.3 1.00000</td><td>0.00000 ␣</td><td>0.00000</td><td>3.57414</td><td></td></tr><tr><td>0-1A -&gt; ↪ →</td><td>2-1A 0.00000357419113</td><td>4864.738936 0.00000</td><td>39236769.7 0.00000</td><td>0.3 1.00000</td><td>0.00000 ␣</td><td>0.00000</td><td>3.57419</td><td></td></tr><tr><td>0-1A -&gt;</td><td>3-1A</td><td>4865.587026 2.60639</td><td>39243610.0 0.00000</td><td>0.3 0.02007</td><td>0.00038 ␣</td><td>0.00000</td><td>2.91269</td><td></td></tr><tr><td>↪ → 0.00014515284191 0-1A -&gt;</td><td>4-1A 0.00014514667816</td><td>4865.587084 2.60650</td><td>39243610.5 0.00000</td><td>0.3 0.02007</td><td>0.00038 ␣</td><td>0.00000</td><td>2.91280</td><td></td></tr><tr><td>↪ → 0-1A -&gt;</td><td>5-1A 0.00014515283005</td><td>4865.587090 2.60639</td><td>39243610.6 0.00000</td><td>0.3 0.02007</td><td>0.00038 ␣</td><td>0.00000</td><td>2.91281</td><td></td></tr><tr><td>↪ → 0-1A -&gt;</td><td>6-1A 0.00000000001034</td><td>4868.943422 0.12373</td><td>39270681.2 0.00000</td><td>0.3 0.00436</td><td>0.00000 ␣</td><td>0.00000</td><td>0.00000</td><td></td></tr><tr><td>↪ → 0-1A -&gt; ↪</td><td>7-1A 0.00020716626448</td><td>4872.449970 3.96936</td><td>39298963.4 0.00000</td><td>0.3 0.31872</td><td>0.00082 ␣</td><td>0.00000</td><td>66.02903</td><td></td></tr><tr><td>→ 0-1A -&gt; ↪ → 0.00020716617979</td><td>8-1A</td><td>4872.450113 3.96990</td><td>39298964.6 0.00000</td><td>0.3 0.31875</td><td>0.00082 ␣</td><td>0.00000</td><td>66.03525</td><td></td></tr><tr><td>0-1A -&gt; ↪ →</td><td>9-1A 0.00020743853075</td><td>4872.450248 3.96694</td><td>39298965.7 0.00000</td><td>0.3 0.31849</td><td>0.00082 ␣</td><td>0.00000</td><td>66.06697</td><td></td></tr><tr><td>0-1A -&gt; ↪ →</td><td>10-1A 0.00000000001255</td><td>4873.185027 1.59564</td><td>39304892.1 0.00000</td><td>0.3 0.11619</td><td>0.00000 ␣</td><td>0.00000</td><td>0.00000</td><td></td></tr></tbody></table>
<p>(continues on next page)</p>
<p>(continued from previous page)</p>
<table><tbody><tr><td>0-1A -&gt; 11-1A ↪ 0.00112267473065</td><td>4873.752986 1.02639</td><td>39309473.0 0.00000</td><td>0.3 0.05806</td><td>0.00115</td><td>0.00000</td><td>65.17922 ␣</td></tr><tr><td>→ 0-1A -&gt; 12-1A</td><td>4873.753219 1.02659</td><td>39309474.8 0.00000</td><td>0.3 0.05807</td><td>0.00115</td><td>0.00000</td><td>65.20318 ␣</td></tr><tr><td>↪ → 0.00112279513057 0-1A -&gt; 13-1A ↪ 0.00112283712761</td><td>4873.753350 1.02629</td><td>39309475.9 0.00000</td><td>0.3 0.05805</td><td>0.00115</td><td>0.00000</td><td>65.18429 ␣</td></tr><tr><td>→ 0-1A -&gt; 14-1A ↪ 0.00000096238863</td><td>4873.877226 0.00274</td><td>39310475.0 0.00000</td><td>0.3 0.99737</td><td>0.00000</td><td>0.00000</td><td>0.95985 ␣</td></tr><tr><td>→ 0-1A -&gt; 15-1A 0.00000096000219</td><td>4873.877345 0.00031</td><td>39310476.0 0.00000</td><td>0.3 0.99955</td><td>0.00000</td><td>0.00000</td><td>0.95957 ␣</td></tr><tr><td>↪ → 0-1A -&gt; 16-1A ↪ 0.00005920440172</td><td>4881.110098 0.00000</td><td>39368812.1 0.00000</td><td>0.3 1.00000</td><td>0.00000</td><td>0.00000</td><td>59.20440 ␣</td></tr><tr><td>→ 0-1A -&gt; 17-1A ↪ → 0.00005920493511</td><td>4881.110123 0.00000</td><td>39368812.3 0.00000</td><td>0.3 1.00000</td><td>0.00000</td><td>0.00000</td><td>59.20493 ␣</td></tr><tr><td>0-1A -&gt; 18-1A ↪ -0.00004102527947</td><td>4883.621665 -0.36365</td><td>39389069.2 -0.00000</td><td>0.3 -0.03920</td><td>0.00001</td><td>0.00000</td><td>1.60824 ␣</td></tr><tr><td>→ 0-1A -&gt; 19-1A ↪ -0.00004102945913</td><td>4883.621737 -0.36356</td><td>39389069.8 -0.00000</td><td>0.3 -0.03921</td><td>0.00001</td><td>0.00000</td><td>1.60871 ␣</td></tr><tr><td>→ 0-1A -&gt; 20-1A ↪ -0.00004103096489</td><td>4883.621842 -0.36367</td><td>39389070.7 -0.00000</td><td>0.3 -0.03922</td><td>0.00001</td><td>0.00000</td><td>1.60930 ␣</td></tr><tr><td>→ 0-1A -&gt; 21-1A ↪ -0.00001710675356</td><td>4884.177852 -9.27427</td><td>39393555.2 -0.00000</td><td>0.3 -0.42849</td><td>0.00016</td><td>0.00000</td><td>7.33000 ␣</td></tr><tr><td>→ 0-1A -&gt; 22-1A ↪ → -0.00001711175162</td><td>4884.178076 -9.27075</td><td>39393557.0 -0.00000</td><td>0.3 -0.42832</td><td>0.00016</td><td>0.00000</td><td>7.32938 ␣</td></tr><tr><td>0-1A -&gt; 23-1A ↪</td><td>4884.178104 -9.26257</td><td>39393557.2 -0.00000</td><td>0.3 -0.42793</td><td>0.00016</td><td>0.00000</td><td>7.32928 ␣</td></tr><tr><td>→ -0.00001712730312 0-1A -&gt; 24-1A ↪ → -0.00000000000329</td><td>4885.935396 -1.98584</td><td>39407730.7 -0.00000</td><td>0.3 -0.11175</td><td>0.00000</td><td>0.00000</td><td>0.00000 ␣</td></tr><tr><td>0-1A -&gt; 25-1A ↪ → 0.00000000016832</td><td>4885.941881 0.01099</td><td>39407783.0 1.00335</td><td>0.3 0.00021</td><td>0.00000</td><td>0.00017</td><td>0.00000 ␣</td></tr></tbody></table>
<p>The multipole moments up to 2nd order:</p>
<ul>
<li style="list-style-type: '· ';">Only approximate origin independence is achieved by using the length approximation for distances from the excited atom up to about 5 Angstrom.</li>
<li style="list-style-type: '· ';">Can form negative intensities which can be partly cured by using larger basis sets.</li>
</ul>
<p>Starting from ORCA version 6.0 the full semi-classical ligth-matter interaction[647][648][649] can be computed by including the keyword:</p>
<table><tbody><tr><td>DoFullSemiclassical true</td></tr></tbody></table>
<p>Resulting in:</p>
<table><tbody><tr><th colspan="7">----------------------------------------------------------------------------- ABSORPTION SPECTRUM VIA FULL SEMI-CLASSICAL FORMULATION</th></tr><tr><th colspan="3">Transition</th><th>Energy (eV)</th><th>Energy (cm-1)</th><th>Wavelength (nm) -----------------------------------------------------------------------------</th><th>fosc(FFMIO)</th></tr><tr><td>0-1A</td><td>-&gt;</td><td>1-1A</td><td>4864.738909</td><td>39236769.5</td><td>0.3</td><td>0.00000225252009</td></tr><tr><td>0-1A</td><td>-&gt;</td><td>2-1A</td><td>4864.738936</td><td>39236769.7</td><td>0.3</td><td>0.00000225274848</td></tr><tr><td>0-1A</td><td>-&gt;</td><td>3-1A</td><td>4865.587026</td><td>39243610.0</td><td>0.3</td><td>0.00021278365996</td></tr><tr><td>0-1A</td><td>-&gt;</td><td>4-1A</td><td>4865.587084</td><td>39243610.5</td><td>0.3</td><td>0.00021278361154</td></tr><tr><td>0-1A</td><td>-&gt;</td><td>5-1A</td><td>4865.587090</td><td>39243610.6</td><td>0.3</td><td>0.00021278187385</td></tr><tr><td>0-1A</td><td>-&gt;</td><td>6-1A</td><td>4868.943422</td><td>39270681.2</td><td>0.3</td><td>0.00000000000237</td></tr><tr><td>0-1A</td><td>-&gt;</td><td>7-1A</td><td>4872.449970</td><td>39298963.4</td><td>0.3</td><td>0.00024200529569</td></tr><tr><td>0-1A</td><td>-&gt;</td><td>8-1A</td><td>4872.450113</td><td>39298964.6</td><td>0.3</td><td>0.00024205635341</td></tr><tr><td>0-1A</td><td>-&gt;</td><td>9-1A</td><td>4872.450248</td><td>39298965.7</td><td>0.3</td><td>0.00024227298357</td></tr><tr><td>0-1A</td><td>-&gt;</td><td>10-1A</td><td>4873.185027</td><td>39304892.1</td><td>0.3</td><td>0.00000000004292</td></tr><tr><td>0-1A</td><td>-&gt;</td><td>11-1A</td><td>4873.752986</td><td>39309473.0</td><td>0.3</td><td>0.00086416333614</td></tr></tbody></table>
<p>(continues on next page)</p>
<p>(continued from previous page)</p>
<pre><code>0-1A -> 12-1A 4873.753219 39309474.8 0.3 0.00086431970479 0-1A -> 13-1A 4873.753350 39309475.9 0.3 0.00086419143873 0-1A -> 14-1A 4873.877226 39310475.0 0.3 0.00000011039866 0-1A -> 15-1A 4873.877345 39310476.0 0.3 0.00000010856486 0-1A -> 16-1A 4881.110098 39368812.1 0.3 0.00000159577723 0-1A -> 17-1A 4881.110123 39368812.3 0.3 0.00000159558300 0-1A -> 18-1A 4883.621665 39389069.2 0.3 0.00000254791052 0-1A -> 19-1A 4883.621737 39389069.8 0.3 0.00000254735746 0-1A -> 20-1A 4883.621842 39389070.7 0.3 0.00000254890168 0-1A -> 21-1A 4884.177852 39393555.2 0.3 0.00008141388446 0-1A -> 22-1A 4884.178076 39393557.0 0.3 0.00008141175909 0-1A -> 23-1A 4884.178104 39393557.2 0.3 0.00008140437907 0-1A -> 24-1A 4885.935396 39407730.7 0.3 0.00000000004646 0-1A -> 25-1A 4885.941881 39407783.0 0.3 0.00000000003815</code></pre>
<p>The full-semiclassical transition moments:</p>
<ul>
<li style="list-style-type: '· ';">Behave like the multipole expansion in the velocity representation.</li>
<li style="list-style-type: '· ';">They are by definition origin independent they do not suffer from artificial negative values like the multipole moments beyond 1st order.</li>
</ul>
<h2>Note</h2>
<ul>
<li style="list-style-type: '· ';">For information on plotting the obtained spectra check orca_mapspc</li>
</ul>
<p>Now, let us turn to the Cl K-edge. Looking at the output of the first calculation, we have:</p>
<pre><code>----------------ORBITAL ENERGIES ----------------NO OCC E(Eh) E(eV) 0 2.0000 -178.943613 -4869.3033 1 2.0000 -101.066445 -2750.1578 2 2.0000 -101.066399 -2750.1565 3 2.0000 -101.066377 -2750.1559 4 2.0000 -101.066372 -2750.1558 5 2.0000 -19.810459 -539.0700 6 2.0000 -16.410626 -446.5558 7 2.0000 -16.410625 -446.5558 8 2.0000 -16.410625 -446.5558 9 2.0000 -9.272000 -252.3039 10 2.0000 -9.271962 -252.3029 11 2.0000 -9.271945 -252.3024 12 2.0000 -9.271940 -252.3023 ...</code></pre>
<p>And looking at the energy range or the orbital composition, we find that orbitals 1 through 4 are Cl 1s-orbitals. They all have the same energy since they are essentially non-interacting. Hence, we can localize them without invalidating the calculation. To this end, you can invoke the automatic localization for XAS which modifies the input to:</p>
<pre><code>! BP86 x2c x2c-SVPall x2c/J TightSCF %tddft XASLoc[0] = 1,4 OrbWin[0] = 1,1,-1,-1 NRoots 25 DecomposeFosc true DoFullSemiclassical true</code></pre>
<p>(continues on next page)</p>
<pre><code>end * int 0 1 Ti 0 0 0 0 0 0 Cl 1 2 3 2.15 0 0 Cl 1 2 3 2.15 109.4712 0 Cl 1 2 3 2.15 109.4712 120 Cl 1 2 3 2.15 109.4712 240 *</code></pre>
<ul>
<li style="list-style-type: '· ';">This localizes the orbitals 1 through 4 of operator 0 (the closed-shell) and then allows excitations (arbitrarily) from core hole 1 only. You could choose any of the three other localized 1s orbitals instead without changing the result. You could even do all four core holes simultaneously (they produce identical spectra) in which case you have the entire ligand K-edge intensity and not just the one normalized to a single chlorine (this would be achieved with OrbWin[0] = 1,4,-1,-1 ).</li>
<li style="list-style-type: '· ';">If you have a spin unrestricted calculation, you need to give the same XASLoc and OrbWin information for the spin-down orbitals as well.</li>
</ul>
<h2>The obtained Cl K-edge absorption is:</h2>
<table><tbody><tr><th colspan="3">----------------------------------------------------------------------------------- ↪ → ----------------- -----------------------------------------------------------------------------------</th><th>ABSORPTION SPECTRUM VIA</th><th>TRANSITION</th><th>ELECTRIC</th><th>DIPOLE</th><th>MOMENTS</th><td></td></tr><tr><th>→</th><th colspan="2">----------------- Transition Energy</th><th>Energy</th><th>Wavelength</th><th>fosc(D2)</th><td>D2</td><th>DX</th><th>␣</th></tr><tr><th>↪ → DY</th><td>DZ</td><td></td><th>(eV)</th><th>(nm)</th><td></td><th>(au**2)</th><th>(au)</th><th>␣</th></tr><tr><th>↪ → (au)</th><td></td><td></td><th>(cm-1)</th><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><th>(au)</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><th>↪ →</th><th>-----------------</th><td></td><td></td><td></td><th>-----------------------------------------------------------------------------------</th><td></td><td></td><td></td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 1-1A 0.00000</td><td>2745.600263 0.00280</td><td>22144761.9</td><td>0.5</td><td>0.000527911</td><td>0.00001</td><td>0.</td><td></td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 2-1A -0.00280</td><td>2745.600291 0.00000</td><td>22144762.1</td><td>0.5</td><td>0.000527960</td><td>0.00001</td><td>-0.</td><td></td></tr><tr><td>0-1A ↪ 00001</td><td>-&gt; 3-1A -0.00257</td><td>2746.447743 -0.00000</td><td>22151597.3</td><td>0.5</td><td>0.000444357</td><td>0.00001</td><td>0.</td><td></td></tr><tr><td>→ 0-1A ↪ → 00000</td><td>-&gt; 4-1A 0.00000</td><td>2746.447798 -0.00257</td><td>22151597.7</td><td>0.5</td><td>0.000444395</td><td>0.00001</td><td>0.</td><td></td></tr><tr><td>0-1A ↪ → 00455</td><td>-&gt; 5-1A -0.00000</td><td>2746.458249 -0.00000</td><td>22151682.0</td><td>0.5</td><td>0.001391214</td><td>0.00002</td><td>-0.</td><td></td></tr><tr><td>0-1A ↪ → 00127</td><td>-&gt; 6-1A 0.00000</td><td>2749.820836 -0.00000</td><td>22178803.1</td><td>0.5</td><td>0.000108586</td><td>0.00000</td><td>-0.</td><td></td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 7-1A -0.00000</td><td>2753.309672 -0.00309</td><td>22206942.5</td><td>0.5</td><td>0.000642499</td><td>0.00001</td><td>-0.</td><td></td></tr><tr><td>0-1A ↪ → 00004</td><td>-&gt; 8-1A -0.00309</td><td>2753.309873 0.00000</td><td>22206944.1</td><td>0.5</td><td>0.000643000</td><td>0.00001</td><td>-0.</td><td></td></tr><tr><td>0-1A ↪ → 00505</td><td>-&gt; 9-1A -0.00002</td><td>2753.320060 -0.00000</td><td>22207026.2</td><td>0.5</td><td>0.001717215</td><td>0.00003</td><td>0.</td><td></td></tr><tr><td>0-1A ↪ → 00507</td><td>-&gt; 10-1A -0.00000</td><td>2753.907046 0.00000</td><td>22211760.6</td><td>0.5</td><td>0.001737693</td><td>0.00003</td><td>-0.</td><td></td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 11-1A 0.00064</td><td>2754.608481 -0.00000</td><td>22217418.1</td><td>0.5</td><td>0.000027939</td><td>0.00000</td><td>0.</td><td></td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 12-1A 0.00000</td><td>2754.608709 0.00064</td><td>22217419.9</td><td>0.5</td><td>0.000027879</td><td>0.00000</td><td>-0.</td><td></td></tr><tr><td>0-1A</td><td>-&gt; 13-1A</td><td>2754.709845</td><td>22218235.6</td><td>0.5</td><td>0.000149389</td><td>0.00000</td><td>0.</td><td></td></tr></tbody></table>
<p>(continued from previous page)</p>
<p>(continues on next page)</p>
<p>(continued from previous page)</p>
<table><tbody><tr><td>↪ → 00149 0-1A ↪ → 00001</td><td>-0.00001 -&gt; 14-1A -0.00318</td><td>0.00000 2754.736803 0.00000</td><td>22218453.0</td><td>0.5</td><td>0.000681956</td><td>0.00001</td><td>-0.</td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 15-1A 0.00000</td><td>2754.736928 0.00318</td><td>22218454.0</td><td>0.5</td><td>0.000682692</td><td>0.00001</td><td>-0.</td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 16-1A -0.00000</td><td>2761.966240 0.00102</td><td>22276762.4</td><td>0.4</td><td>0.000069982</td><td>0.00000</td><td>0.</td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 17-1A 0.00102</td><td>2761.966265 0.00000</td><td>22276762.6</td><td>0.4</td><td>0.000069999</td><td>0.00000</td><td>0.</td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 18-1A -0.00214</td><td>2764.478344 -0.00001</td><td>22297023.9</td><td>0.4</td><td>0.000309542</td><td>0.00000</td><td>0.</td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 19-1A -0.00001</td><td>2764.478355 0.00214</td><td>22297024.0</td><td>0.4</td><td>0.000309644</td><td>0.00000</td><td>0.</td></tr><tr><td>0-1A ↪ → 00250</td><td>-&gt; 20-1A -0.00000</td><td>2764.662301 0.00000</td><td>22298507.6</td><td>0.4</td><td>0.000422965</td><td>0.00001</td><td>-0.</td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 21-1A 0.00131</td><td>2765.033563 -0.00000</td><td>22301502.0</td><td>0.4</td><td>0.000115414</td><td>0.00000</td><td>0.</td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 22-1A 0.00000</td><td>2765.033736 0.00131</td><td>22301503.4</td><td>0.4</td><td>0.000115508</td><td>0.00000</td><td>0.</td></tr><tr><td>0-1A ↪ → 00181</td><td>-&gt; 23-1A 0.00000</td><td>2765.243962 0.00000</td><td>22303199.0</td><td>0.4</td><td>0.000222110</td><td>0.00000</td><td>-0.</td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 24-1A -0.00000</td><td>2766.796424 0.00008</td><td>22315720.5</td><td>0.4</td><td>0.000000384</td><td>0.00000</td><td>0.</td></tr><tr><td>0-1A ↪ → 00000</td><td>-&gt; 25-1A 0.00020</td><td>2766.796522 0.00000</td><td>22315721.3</td><td>0.4</td><td>0.000002667</td><td>0.00000</td><td>0.</td></tr></tbody></table>
<p>Quite nice results have been obtained for a number of systems in this way.[650]</p>
<h2>5.6.15 Transient spectra</h2>
<p>If one wants to compute transient spectra, or transition dipoles starting from a given excited state, the option DOTRANS must be set to TRUE and an IROOT should be given for the initial state (the default is 1). If DOTRANS ALL is requested instead, the transition dipoles between all states are computed. The transient transition dipoles will then be printed after the normal spectra. This option is currently only available for CIS/TDA and is done usng the expectation value formalism, as the other transition dipole moments in ORCA.</p>
<pre><code>%cis DOTRANS TRUE #or DOTRANS ALL end</code></pre>
<h2>5.6.16 Excited State Geometry Optimization</h2>
<p>For RPA, CIS, TDA and TD-DFT the program can calculate analytic gradients. With the help of the IRoot keyword, a given state can be selected for geometry optimization. Note however, that if two states cross during the optimization it may fail to converge or fail to converge to the desired excited state (see section Root Following Scheme for Difficult Cases below)!</p>
<pre><code>® Note · If you want to follow a triplet state instead of the singlet, please include IROOTMULT TRIPLET .</code></pre>
<pre><code>!def2-SVP Opt Freq</code></pre>
<p>(continues on next page)</p>
</div>
</body>
</html>